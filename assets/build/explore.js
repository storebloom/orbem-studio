(()=>{"use strict";var e={295:(e,t,n)=>{function a(){const e=document.querySelectorAll(".upload_image_button");e.length>0&&e.forEach((function(e){o(e)}));const t=document.querySelectorAll(".remove_image_button");t.length>0&&t.forEach((function(e){s(e)}))}function o(e){e.addEventListener("click",(function(e){e.preventDefault();const t=this.dataset.direction,n=wp.media({title:"Select Asset",button:{text:"Use This Asset"},multiple:!1});n.on("select",(function(){const a=n.state().get("selection").first().toJSON();let o=document.getElementById(`explore-character-images[${t}]`);if(o&&"image"===a.type)o.value=a.url;else{const t=e.target.closest(".explore-image-field");t&&(o=t.querySelector(".explore-upload-field"))}o&&(o.value=a.url);const s=document.getElementById("_product_video_url");s&&"video"===a.type&&(s.value=a.url);const r=document.getElementById("_product_video_url_thumbnail");r&&"image"===a.type&&(r.value=a.url)})),n.open()}))}function s(e){e.addEventListener("click",(function(e){e.preventDefault();const t=this.dataset.direction;let n=document.getElementById(`explore-character-images[${t}]`);if(n);else{const t=e.target.closest(".explore-image-field");t&&(n=t.querySelector(".explore-upload-field"))}n&&(n.value="")}))}n.d(t,{X:()=>a}),document.addEventListener("DOMContentLoaded",(function(){a()})),window.initExploreUploadButton=o,window.initExploreRemoveButton=s},704:(e,t,n)=>{n.d(t,{S:()=>s});var a=n(295),o=n(911);function s(){let e=!1;window.devmode=!1;let t=1;const n=document.getElementById("zoom-in"),s=document.getElementById("zoom-out");n&&s&&(n.addEventListener("click",(()=>{p("in")})),s.addEventListener("click",(()=>{p("out")})));let r,c=null,i=0,l=0;function d(e){if(clearTimeout(r),e.preventDefault(),c=e.target.closest(".map-item, .enemy-item"),c.style.transition="",c){const t=c.getBoundingClientRect();i=e.clientX-t.left,l=e.clientY-t.top,e.dataTransfer.setData("text/plain",""),document.addEventListener("mousemove",u)}}function u(e){if(c){const n=document.querySelector(".game-container").getBoundingClientRect(),a="menu"===c.dataset.type?e.clientX:e.clientX-n.left,o="menu"===c.dataset.type?e.clientY:e.clientY-n.top;c.style.left=a/t-i+"px",c.style.top=o/t-l+"px"}}function m(){c&&(r=setTimeout((()=>{const t=`${OrbemOrder.siteRESTURL}/set-item-position/`,n="true"===c.dataset.trigger||!0===c.classList.contains("drag-dest")?c.id.replace("-t","").replace("-d",""):c.id,a={top:c.style.top.replace("px",""),left:c.style.left.replace("px",""),height:c.style.height.replace("px",""),width:c.style.width.replace("px",""),id:n,meta:c.dataset?.meta};n===e&&(a.walkingPath="true"),fetch(t,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":OrbemOrder.orbemNonce},body:JSON.stringify(a)}).then((e=>{if(!e.ok)throw new Error("Network response was not ok "+e.statusText)})),c=null}),1e3),document.removeEventListener("mousemove",u))}function p(e){const n=document.querySelector(".game-container"),a=document.getElementById("zoom-amount");if(n){let o=void 0!==n.style.transform&&""!==n.style.transform?n.style.transform:"1";o=parseFloat(o.replace("scale(","").replace(")","")),o="in"===e?+(o+.1).toFixed(10):+(o-.1).toFixed(10),a&&(a.textContent=(100*o).toString()),t=o,n.style.transform="scale("+o+")"}}const g=document.querySelector("#new-addition");g&&(g.addEventListener("click",(e=>{!1===e.target.classList.contains("close-settings")&&!1===e.target.parentNode.classList.contains("character-item")&&g.classList.add("engage")})),g.querySelector(".close-settings").addEventListener("click",(()=>{const e=document.querySelector(".retrieval-points #item-description");g.classList.remove("engage"),e&&(e.innerHTML="")})));const y=document.querySelector(".level-selector"),f=document.getElementById("select-level");y&&f&&f.addEventListener("click",(()=>{y.classList.add("engage"),y.querySelectorAll("img").forEach((e=>{e.addEventListener("click",(()=>{const t=e.src,n=e.dataset.name;(0,o.Z)(),(0,o.U)(n,t)}))}))}));const w=document.querySelector(".dev-mode-menu-toggle");w&&w.addEventListener("click",(()=>{const e=document.querySelector(".dev-mode-menu");if(e){e.classList.toggle("engage"),w.classList.toggle("engage");const t=document.querySelectorAll('.explainer-container, [data-genre="explore-wall"], [data-trigger="true"], [data-genre="explore-area"], [data-genre="blockade"]');e.classList.contains("engage")?t&&t.forEach((e=>{e.style.backgroundColor="rgb(0,146,255)",e.style.opacity=.3,e.style.zIndex=1})):t&&t.forEach((e=>{e.style.backgroundColor="",e.style.opacity=""}))}})),setTimeout((()=>{const n=document.querySelectorAll(".map-item, .enemy-item"),o=document.querySelectorAll(".find-explore-item"),s=document.getElementById("map-character"),r=document.querySelectorAll("#add-new-list li"),c=document.getElementById("god-mode"),i=document.getElementById("no-touch"),l=document.getElementById("open-pinpoint"),u=document.querySelector(".pinpoint-container");function p(e){e.stopPropagation();const t=document.getElementById("top-pinpoint"),n=document.getElementById("left-pinpoint");t.value=window.mouseY,n.value=window.mouseX,u.classList.remove("engage"),document.removeEventListener("click",p),document.removeEventListener("mousemove",g),document.body.style.cursor="default"}function g(e){const t=document.querySelector(".game-container").getBoundingClientRect();window.mouseX=parseInt(e.clientX-t.left),window.mouseY=parseInt(e.clientY-t.top)}if(l&&l.addEventListener("click",(()=>{document.body.style.cursor="copy",u.classList.add("engage"),setTimeout((()=>{document.addEventListener("click",p),document.addEventListener("mousemove",g)}),0)})),window.godMode=!1,window.noTouch=!1,c&&i&&(c.addEventListener("change",(()=>{c.checked?window.godMode=!0:window.godMode=!1})),i.addEventListener("change",(()=>{i.checked?(window.noTouch=!0,s.style.zIndex="0"):window.noTouch=!1}))),r&&r.forEach((function(e){e.addEventListener("click",(()=>{const t=e.dataset.type;e.classList.add("engage");const n=`${OrbemOrder.siteRESTURL}/get-new-fields/`,o={type:t};fetch(n,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":OrbemOrder.orbemNonce},body:JSON.stringify(o)}).then((e=>{if(!e.ok)throw new Error("Network response was not ok "+e.statusText);return e.json()})).then((e=>{const t=document.querySelector(".add-new-fields");t&&(t.innerHTML=e.data,"function"==typeof a.X&&((0,a.X)(),function(){const e=document.getElementById("add-new-form");e&&e.addEventListener("submit",(function(t){t.preventDefault();const n=function(e){const t=Object.fromEntries(e.entries()),n={};for(const[e,a]of Object.entries(t)){const t=e.replace(/\]/g,"").split("[");let o=n;for(;t.length>1;){const e=t.shift();e in o||(o[e]={}),o=o[e]}o[t[0]]=a}return n}(new FormData(e)),a=`${OrbemOrder.siteRESTURL}/add-new/`,o=document.querySelector("#add-new-list li.engage");let s="";o&&(s=o.dataset.type);let r=document.querySelector(".game-container");r=r.className.replace("game-container ","");const c={type:s,area:null!=r?r:"",values:n};fetch(a,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":OrbemOrder.orbemNonce},body:JSON.stringify(c)}).then((e=>{if(!e.ok)throw new Error("Network response was not ok "+e.statusText);window.location.reload()}))}))}()))}))}))})),o&&o.length>0){o.forEach((t=>{const n=t.querySelector(".find-title"),a=t.querySelector(".edit-item-button"),o=t.querySelector(".show-hide-item"),r=t.querySelector(".close-item-button");if(a&&o){const n=a.closest(".find-explore-item").id.replace("-f",""),s=document.getElementById(n);o.addEventListener("click",(()=>{!0===o.classList.contains("show")?(s.style.display="none",o.textContent="ðŸ«£"):(s.style.display="block",o.textContent="ðŸ‘ï¸"),o.classList.toggle("show")})),a.addEventListener("click",(()=>{if(!0!==a.classList.contains("created")){const o=document.createElement("div"),c=document.createElement("label"),i=document.createElement("input"),l=document.createElement("label"),d=document.createElement("input"),u=document.createElement("button");let m=s.style.height;m=m?m.replace("px",""):"";let p=s.style.width;if(p=p?p.replace("px",""):"",r.style.display="block",c.textContent="Height",l.textContent="Width",o.classList.add("size-input"),i.type="number",i.value=m&&""!==m?m:s.dataset?.height,d.type="number",d.value=p&&""!==p?p:s.dataset?.width,u.classList.add("submit-size"),u.textContent="submit",c.appendChild(i),l.appendChild(d),o.appendChild(c),o.appendChild(l),o.appendChild(u),"explore-character"===t.dataset.posttype||"explore-enemy"===t.dataset.posttype){const t=document.createElement("label"),a=document.createElement("input");a.type="checkbox",t.textContent="Record Walking Path",t.appendChild(a),o.appendChild(t),a.addEventListener("change",(()=>{e=!!a.checked&&n}))}t.appendChild(o),a.classList.add("created"),u.addEventListener("click",(()=>{const e=`${OrbemOrder.siteRESTURL}/set-item-size/`,c={height:i.value,width:d.value,id:n,meta:t.dataset?.meta};fetch(e,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":OrbemOrder.orbemNonce},body:JSON.stringify(c)}).then((e=>{if(!e.ok)throw new Error("Network response was not ok "+e.statusText);o.remove(),a.classList.remove("created"),r.style.display="none",s&&(s.style.height=`${i.value}px`,s.style.width=`${d.value}px`)}))})),r.addEventListener("click",(()=>{o.remove(),a.classList.remove("created"),r.style.display="none"}))}}))}n.addEventListener("click",(e=>{const n=e.target.closest(".find-explore-item"),a=document.querySelector("."+n.dataset.class+'[data-genre="'+n.dataset.posttype+'"]'),o=document.querySelector(".map-item.selected"),r=document.querySelector(".find-explore-item.selected");o&&o.classList.remove("selected"),r&&r.classList.remove("selected"),a&&(s.style.left=parseInt(a.style.left.replace("px",""))-200+"px",s.style.top=parseInt(a.style.top.replace("px",""))-200+"px",a.scrollIntoView(),a.classList.add("selected"),t.classList.add("selected"))}))}));const v=document.querySelectorAll(".explore-list-group");v.length>0&&v.forEach((e=>{""===e.textContent&&e.remove();const t=e.querySelector(".item-post-type");t&&t.addEventListener("click",(()=>{e.classList.toggle("engage")}))}))}n&&n.length&&n.forEach((e=>{e.draggable=!0,e.addEventListener("dragstart",d),e.addEventListener("mouseup",m)}));const y=document.getElementById("engage-wallbuilder"),f=document.querySelector(".wallbuilder-container"),w=document.querySelector(".default-map");let h=!1;if(y){y.addEventListener("click",(()=>{f.classList.toggle("engage"),f.classList.contains("engage")?(document.body.style.cursor="cell",document.addEventListener("mousedown",L)):(document.body.style.cursor="default",document.removeEventListener("mousedown",L))}));let b=0,S=0;function L(e){h=!0,e.preventDefault();const n=document.createElement("div");n.draggable=!0;const a=document.querySelector(".game-container").getBoundingClientRect(),o=(e.clientX-a.left)/t,s=(e.clientY-a.top)/t;function r(e){if(h&&n){const a=document.querySelector(".game-container").getBoundingClientRect(),o=(e.clientX-a.left)/t,s=(e.clientY-a.top)/t,r=parseFloat(n.style.left.replace("px","")),c=parseFloat(n.style.top.replace("px",""));n.style.width=o-r+"px",n.style.height=s-c+"px"}}n.className="wp-block-group map-item",n.style.left=o-b+"px",n.style.top=s-S+"px",n.style.backgroundColor="rgb(0,146,255)",n.style.opacity="0.3",n.style.zIndex="1",n.dataset.genre="explore-wall",w.appendChild(n),document.addEventListener("mousemove",r),document.addEventListener("mouseup",(function e(){h=!1;const t=`${OrbemOrder.siteRESTURL}/add-new/`;let a=document.querySelector(".game-container");a=a.className.replace("game-container ","");const o=n.style.top.replace("px",""),s=n.style.left.replace("px",""),c=n.style.width.replace("px",""),i=n.style.height.replace("px","");if(0<parseInt(c)&&0<parseInt(i)){const e={type:"explore-wall",area:null!=a?a:"",values:{title:"wall-"+a+"-"+o+"-"+s,"explore-width":c,"explore-height":i,"explore-top":o,"explore-left":s}};fetch(t,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":OrbemOrder.orbemNonce},body:JSON.stringify(e)}).then((e=>{if(!e.ok)throw new Error("Network response was not ok "+e.statusText);return e.json()})).then((e=>{n.id=e.data,n.className=n.className+" wall-"+a+"-"+o.toString().replace(".","-")+"-"+s.toString().replace(".","-")+"-map-item is-layout-flow wp-block-group-is-layout-flow",n.dataset.width=c,n.dataset.height=i,n.addEventListener("dragstart",d),n.addEventListener("mouseup",m)}))}else n.addEventListener("dragstart",d),n.addEventListener("mouseup",m);document.removeEventListener("mousemove",r),document.removeEventListener("mouseup",e)}))}}}),2500);const h=document.querySelector(".explore-item-list");if(h){const e=document.querySelector(".open-close-item-list");e&&e.addEventListener("click",(()=>{h.classList.toggle("engage")}))}}document.addEventListener("DOMContentLoaded",(function(){s()}))},911:(e,t,n)=>{n.d(t,{U:()=>Te,Z:()=>me});var a=n(704);let o,s,r,c,i,l,d,u,m,p,g,y=[],f=[],w="",h="",v=!1,b=!1,S=0,L=!1,x=!1,q=!1,E=!1,k=!1,I="",O=!1,T=400,A=400,N=0;const C=OrbemOrder.defaultWeapon;function B(){const e=document.getElementById("characters"),t=!!e&&e.querySelectorAll(".character-list .character-item");t&&t.forEach((t=>{t.addEventListener("click",(()=>{!function(e){const t=e.querySelector("img");t.removeAttribute("srcset");const n=document.querySelector("#map-character");if(t&&n){const t=void 0===n.dataset.currentchar?window.mainCharacter:n.dataset.currentchar,a=document.querySelectorAll("#map-character .map-character-icon"),o=e.querySelectorAll(".character-images .character-icon");if(a){a.forEach(((e,t)=>{if(o[t]){const n=e.src;e.src=o[t].src,o[t].src=n}}));const t=n.dataset.ability,s=n.dataset.name;n.dataset.currentchar=e.dataset.charactername,n.dataset.ability=e.dataset.ability,n.dataset.name=e.querySelector(".character-name").textContent,e.dataset.ability=t,e.querySelector(".character-name").textContent=s}switch(n.dataset?.ability){case"speed":window.moveSpeed=5,window.attackMultiplier=5,Ae(),K(document.querySelector('.storage-item[title="'+n.dataset?.weapon+'"]'));break;case"programming":K(document.querySelector('.storage-item[data-type="weapons"].equipped')),window.moveSpeed=3,window.attackMultiplier=0,Ae();break;case"strength":window.moveSpeed=3,Ae(),K(document.querySelector('.storage-item[title="'+n.dataset?.weapon+'"]')),window.attackMultiplier=10;break;case"hazard":window.moveSpeed=3,Ae(),K(document.querySelector('.storage-item[title="'+n.dataset?.weapon+'"]')),window.attackMultiplier=0;break;case"default":window.moveSpeed=3,K(document.querySelector('.storage-item[title="'+n.dataset?.weapon+'"]')),Ae()}e.dataset.charactername=t||window.mainCharacter}}(t),e.classList.remove("engage")}))}))}function M(e,t){let n;if(e){let a=!1;!1!==t&&(a=e,e=t);const o=e.dataset.path,s=e.dataset.speed,r=void 0===e.dataset?.timebetween?"0":e.dataset.timebetween,c=e.dataset?.repeat,i="yes"===e.dataset?.wanderer;if(!1!==t&&a&&(e=a),o&&!1===i){const t=JSON.parse(o);t.unshift({top:e.style.top.replace("px",""),left:e.style.left.replace("px","")});const a=t.length-1;let i,l,d=0,u=1,m=0,p=0,g=!0,y=!1;const f=Ne(e.className);if(t&&1!==t.length){let o,w,h=t[d].left,v=t[d].top,b=!1;n=setInterval((()=>{if("false"!==e.dataset?.canmove){const S=e.querySelector(".character-icon.engage");u=d===a?0:d+1,p=function(e,t,n,a,o,s){o="0"===o?"60":o,s="0"===s?"0.175":s;const r=Math.hypot(e-n,t-a)*parseFloat(s)*o;return Math.ceil(r/250)}(t[d].left,t[d].top,t[u].left,t[u].top,s,r),m===p-1||g?((a>d||g&&a===d)&&(S&&S.classList.remove("engage"),i=le(t[d].left,t[d].top,t[u].left,t[u].top,e,s),e.style.left=t[u].left+"px",e.style.top=t[u].top+"px",l=e.querySelector("#"+f+i),l&&(l.classList.add("engage"),y=!1)),!1===g?a>u?(m=0,g=!0,0!==u?d++:d=0):"true"===c?(g=!0,d=a,m=0):a===u&&clearInterval(n):(g=!1,m++)):m++;const L=()=>{parseInt(t[u].left)===e.offsetLeft&&parseInt(t[u].top)===e.offsetTop&&!0!==y&&(D(i,e),y=!0),h=e.offsetLeft,v=e.offsetTop,o=e.offsetLeft,w=e.offsetTop,requestAnimationFrame(L)};L(),b=!1}else!1===b&&(p+=1,d=0<d?d-1:a,D(i,e),e.style.left=h+"px",e.style.top=v+"px",b=!0)}),250)}else le(e.style.left.replace("px",""),e.style.top.replace("px",""),t[d].left,t[d].top,e,s),e.style.left=t[u].left+"px",e.style.top=t[u].top+"px"}else!0===i&&function(e,t,n){let a=W([]),o="",s=!1,r=!1,c=!1,i=!1,l=0,d=0,u="",m=0;(function t(){const a=Math.floor(10001*Math.random())+15e3;setTimeout((()=>{H(n,e),t()}),a)})(),setInterval((()=>{if("true"!==e.dataset?.break&&"true"!==e.dataset?.cutscenebreak){const t=e.style.left.replace("px",""),p=e.style.top.replace("px",""),g=Be(p,t,e);switch(a){case"down":e.style.top=g.top+1+"px";break;case"up":e.style.top=g.top-1+"px";break;case"left":e.style.left=g.left-1+"px";break;case"right":e.style.left=g.left+1+"px"}switch(u=o,((g.left>t||g.left<t)&&!0===g.collide&&!1===s&&("left"===a||"right"===a)||!0===g.collide&&g.top>p)&&(o=m%2==0?"down":"up"),(("down"===o&&g.top<p||"up"===o&&g.top>p)&&!0===g.collide&&("left"===a||"right"===a)||g.left>t&&!0===s)&&(o="down"===o?"up":"down",s=!0),g.top>p&&!0===g.collide&&!0===s&&("left"===a||"right"===a)&&(i=!0),!(g.top>p||g.top<p)||!0!==g.collide||!1!==r||"up"!==a&&"down"!==a||(o=m%2==0?"left":"right"),(("left"===o&&g.left>t||"right"===o&&g.left<t)&&!0===g.collide&&("up"===a||"down"===a)||g.top>p&&!0===r)&&(o="left"===o||"down"===o?"right":"left",r=!0),g.left<t&&!0===g.collide&&!0===r&&(c=!0),(!0===r&&!0===c||!0===i&&!0===s)&&(o="",a=W(a),r=!1,c=!1,i=!1,s=!1,m++),o){case"down":"up"!==a?e.style.top=g.top+1+"px":o="";break;case"up":"down"!==a?e.style.top=g.top-1+"px":o="";break;case"left":"right"!==a?e.style.left=g.left-1+"px":o="";break;case"right":"left"!==a?e.style.left=g.left+1+"px":o=""}!1===g.collide?l++:(l=0,u!==o&&d++),d>100&&(H(n,e),o=""),l>20&&(d=0,s=!1,i=!1,r=!1,c=!1,o="",m++)}else a=W(a)}),t)}(e,s,r)}}function P(){const e=document.querySelectorAll(".menu-tabs > div");e&&e.forEach(((e,t)=>{e.addEventListener("click",(()=>{const t=document.querySelector(".menu-tabs .engage"),n=document.getElementById("item-description");n&&(n.innerHTML=""),t&&t.classList.remove("engage");const a=document.querySelector('.retrieval-points [data-menu="'+e.className.replace("-tab","")+'"]');e.classList.add("engage");const o=document.querySelector(".storage-menu.engage");o&&o.classList.remove("engage"),a&&a.classList.add("engage")}))}))}function R(){const e=document.querySelectorAll("#settings, #storage, #characters");e&&e.forEach((e=>{if("storage"===e.id){const e=document.querySelectorAll(".retrieval-points .storage-item");e&&e.forEach((e=>{e.addEventListener("click",(()=>{"true"!==e.dataset.empty&&G(e)}))}))}e.addEventListener("click",(t=>{!1!==t.target.classList.contains("close-settings")||t.target.closest(".character-item")||e.classList.add("engage")})),e.querySelector(".close-settings").addEventListener("click",(()=>{const t=document.querySelector(".retrieval-points #item-description");e.classList.remove("engage"),t&&(t.innerHTML="")}))}));const t=document.getElementById("update-settings"),n=document.getElementById("music-volume"),a=document.getElementById("sfx-volume"),o=document.getElementById("talking-volume");t&&(a&&n&&o&&(window.sfxVolume=a.value/100,window.talkingVolume=o.value,n.addEventListener("input",(e=>{window.currentMusic.volume=e.target.value/100})),o.addEventListener("input",(e=>{window.talkingVolume=e.target.value})),a.addEventListener("input",(e=>{window.sfxVolume=e.target.value/100}))),t.addEventListener("click",(()=>{n&&a&&o&&function(e,t,n){const a={music:e,sfx:t,talking:n};fetch(`${OrbemOrder.siteRESTURL}/save-settings/`,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":OrbemOrder.orbemNonce},body:JSON.stringify(a)}).then((e=>{if(!e.ok)throw new Error("Network response was not ok "+e.statusText)}))}(n.value,a.value,o.value)})))}function D(e,t){const n=t.querySelector(".character-icon.engage"),a=Ne(t.className);n&&n.classList.remove("engage");const o=document.getElementById(a+"static-"+e);o&&o.classList.add("engage")}function H(e,t){t.dataset.break="true",setTimeout((()=>{t.dataset.break="false"}),e)}function W(e){const t=Array.isArray(e)?e:[e],n=["up","down","left","right"].filter((e=>!t.includes(e)));return 0===n.length?null:n[Math.floor(Math.random()*n.length)]}function $(e,t,n,a,o){!0===a&&V(n,t),e>100&&"point"!==t&&"money"!==t&&(e=100),e<0&&"health"===t&&(e=0);const s=document.querySelector(`.${t}-amount`);let r=!1;s&&(r=s.querySelector(".gauge")),OrbemOrder.explorePoints&&OrbemOrder.explorePoints[t]&&!1===OrbemOrder.explorePoints[t].positions.includes(n)&&!1===Array.isArray(n)?OrbemOrder.explorePoints[t].positions.push(n):OrbemOrder.explorePoints&&OrbemOrder.explorePoints[t]&&!1===OrbemOrder.explorePoints[t].positions.includes(n)&&!0===Array.isArray(n)&&n.forEach((e=>{OrbemOrder.explorePoints[t].positions.push(e)})),r&&"point"!==t&&"money"!==t?(s.setAttribute("data-amount",e),r.style.width=e+"px"):"point"===t?(s.setAttribute("data-amount",e),r.style.width=z(e),function(e){const t=document.querySelectorAll("[data-unlockable]");t&&t.forEach((t=>{const n=t.dataset.unlockable;parseInt(e)>=parseInt(n)&&"explore-magic"===t.dataset.genre&&(navigator.vibrate(1e3),function(e){const t=`${OrbemOrder.siteRESTURL}/addspell/`,n={spellid:e};fetch(t,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":OrbemOrder.orbemNonce},body:JSON.stringify(n)}).then((e=>{if(!e.ok)throw new Error("Network response was not ok "+e.statusText)}))}(t.id),t.remove())}))}(e)):"money"===t&&(s.setAttribute("data-amount",e),s.querySelector(".money-text").textContent=e),"health"===t&&0===e&&function(){const e=document.querySelector(".game-over-notice");if(e){clearInterval(l);const t=document.querySelector(".try-again"),n=document.querySelector(".default-map");e.style.display="block",window.allowMovement=!1,E=!1,k=!1,j("projectile","health",100,0,"true",!1),n&&F(n.dataset.startleft,n.dataset.starttop),t&&t.addEventListener("click",(()=>{window.location.reload()}))}}(),""!==n&&!0===["money","point","health","mana"].includes(t)&&n!==o&&j(n,t,e,2e3,"",!1)}function j(e,t,n,a,s,r){const c=`${OrbemOrder.siteRESTURL}/add-explore-points/`;"health"===t&&0===n||""!==e&&(clearTimeout(o),!1===Array.isArray(e)?f.push(e):f=e.concat(f),"health"===t&&(f=["projectile"]),f=Array.from(new Set(f)),!0===r&&(n="health"!==t?ee(t)+n:z(t)-n),o=setTimeout((()=>{const e={type:t,item:f,amount:n,reset:s};fetch(c,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":OrbemOrder.orbemNonce},body:JSON.stringify(e)}).then((e=>{if(!e.ok)throw new Error("Network response was not ok "+e.statusText);"communicate"===t&&(t="point"),OrbemOrder.explorePoints&&t&&(OrbemOrder.explorePoints[t].positions&&Array.isArray(OrbemOrder.explorePoints[t].positions)?OrbemOrder.explorePoints[t].positions=OrbemOrder.explorePoints[t].positions.concat(f):OrbemOrder.explorePoints[t].positions=f),f=[]}))}),a))}function z(e){return e/window.nextLevelPointAmount*100+"%"}function J(e,t,n){clearTimeout(s),s=setTimeout((()=>{const a=document.querySelector("."+e+"-mission-item"),o=document.querySelectorAll('[data-materializemission="'+e+'"]');if(o&&o.forEach((e=>{e.style.display="block"})),a){const o=parseInt(a.dataset.points),s=a.dataset.hazardremove,r=a.dataset.ability;X(a);const c=a.dataset.blockade;if(""!==c&&"0"!==JSON.parse(c).top&&document.querySelector("."+a.className.replace("engage","").replace("next-mission","").replace("mission-item","").replace(/\s+/g,"")+"-blockade").remove(),a.style.textDecoration="line-through",null!==s&&s&&"none"!==s){const e=s.split(",");e&&e.forEach((e=>{const t=document.querySelector("."+e+"-drag-dest-map-item");document.querySelector("."+e+"-map-item").remove(),t&&t.remove(),(!0===Array.isArray(n)&&!1===n.includes(e)||!1===Array.isArray(n)&&n!==e)&&j(e,"point",0,2e3,"",!0)}))}if(setTimeout((()=>{a.remove(),r&&"transportation"===r&&(De(),function(){const e={slug:"transportation"};fetch(`${OrbemOrder.siteRESTURL}/enable-ability/`,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":OrbemOrder.orbemNonce},body:JSON.stringify(e)}).then((e=>{if(!e.ok)throw new Error("Network response was not ok "+e.statusText)}))}())}),500),t&&o>0){const a=document.querySelector(`.map-cutscene[data-mission="${e}"]`);a&&qe(Ne(a.className),!1),Re(t,n,!0,o,e)}else t&&0===o&&j(n,"point",0,2e3,"",!0)}const s=`${OrbemOrder.siteRESTURL}/mission/`,r={mission:e};fetch(s,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":OrbemOrder.orbemNonce},body:JSON.stringify(r)}).then((e=>{if(!e.ok)throw new Error("Network response was not ok "+e.statusText)}))}),500)}function X(e){const t=""!==e.dataset.nextmission&&e.dataset.nextmission.split(",");!1!==t&&t.forEach((e=>{if(1===document.querySelectorAll('[data-nextmission*="'+e+'"]').length){const t=document.querySelector("."+e+"-mission-item");if(t){const e=t.dataset.blockade;""!==e&&"0"!==JSON.parse(e).top&&(document.querySelector("."+t.className.replace("mission-item ","").replace("next-mission ","")+"-blockade").style.display="block"),t.classList.add("engage")}}}))}function U(e,t,n,a,o){const s={type:e,itemid:t,amount:n,unequip:a};"weapons"===e&&(window.currentWeapon=C!==o?"-"+o:""),fetch(`${OrbemOrder.siteRESTURL}/equip-explore-item/`,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":OrbemOrder.orbemNonce},body:JSON.stringify(s)}).then((e=>{if(!e.ok)throw new Error("Network response was not ok "+e.statusText);const t=document.getElementById("item-description");t&&(t.innerHTML=""),Ce(document.getElementById("map-character"),"down",!0)}))}function V(e,t){const n=document.querySelector('.retrieval-points span[title="'+e+'"]'),a=n.getAttribute("data-count");n&&(a&&1<a?n.setAttribute("data-count",a-1):(n.setAttribute("data-type",""),n.setAttribute("data-id",""),n.setAttribute("data-value",""),n.setAttribute("title",""),n.setAttribute("data-empty","true"),n.setAttribute("data-count","")),_(0,e,t,0,!0))}function _(e,t,n,a,o){const s=`${OrbemOrder.siteRESTURL}/save-storage-item/`,r={id:e,name:t,value:a,type:n,remove:o};fetch(s,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":OrbemOrder.orbemNonce},body:JSON.stringify(r)}).then((e=>{if(!e.ok)throw new Error("Network response was not ok "+e.statusText)}))}function F(e,t){const n=`${OrbemOrder.siteRESTURL}/coordinates/`,a={left:e.replace("px",""),top:t.replace("px","")};fetch(n,{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json","X-WP-Nonce":OrbemOrder.orbemNonce},body:JSON.stringify(a)}).then((e=>{if(!e.ok)throw new Error("Network response was not ok "+e.statusText)}))}window.mainCharacter="",window.godMode=!1,window.noTouch=!1,window.isDragging="",window.hazardTime=600,document.addEventListener("DOMContentLoaded",(function(){I=document.querySelector(".game-container"),window.mainCharacter=I.dataset?.main,I=I.className.replace("game-container ",""),window.history.pushState({},document.title,window.location.pathname);const e=document.getElementById("intro-video");if(e){const t=document.querySelector(".intro-video.engage");e.play();const n=document.getElementById("unmute");n&&n.addEventListener("click",(()=>{e.muted=!e.muted,n.textContent=e.muted?"ðŸ”‡":"ðŸ”‰"})),e.addEventListener("ended",(()=>{t&&(t.remove(),ze(!0))}));const a=document.getElementById("skip-intro-video");a&&a.addEventListener("click",(()=>{e.pause(),t&&t.remove(),ze(!0)}))}else ze(!0);const t=document.getElementById("explore-create-account"),n=document.getElementById("explore-login-account"),a=document.querySelector(".login-form"),o=document.querySelector(".register-form");t&&a&&n&&(t.addEventListener("click",(()=>{a.style.display="none",o.style.display="block",t.style.display="none",n.style.display="block"})),n.addEventListener("click",(()=>{a.style.display="block",o.style.display="none",n.style.display="none",t.style.display="block"}))),void 0!==OrbemOrder.exploreAbilities&&0<OrbemOrder.exploreAbilities.length&&OrbemOrder.exploreAbilities.includes("transportation")&&De(),document.addEventListener("keydown",(e=>{const t=document.querySelector(".dragme");if("Space"===e.code)if(t&&!0===t.classList.contains("currently-dragging")){setTimeout((()=>{window.allowHit=!0}),100);const e=parseInt(t.style.top.replace("px",""));t.classList.remove("currently-dragging"),t.classList.remove("dragme"),t.style.left=window.dragLeft.left?parseInt(t.style.left.replace("px",""))-2+"px":parseInt(t.style.left.replace("px",""))+2+"px",t.style.top=window.dragTop.higher?e-2+"px":e+2+"px",window.dragLeft=!1,window.dragTop=!1,window.isDragging="",window.draggingDirection="";const n=Ne(t.className),a=document.querySelector("."+n+"-drag-dest-map-item");if(a){const o=parseInt(a.style.left.replace("px",""))+a.offsetWidth/2,s=parseInt(a.style.top.replace("px",""))+a.offsetHeight/2,r=parseInt(t.style.left.replace("px",""))+a.offsetWidth/2,c=e+t.offsetHeight/2,i=r<o?o-r:r-o;(c<s?s-c:c-s)<parseInt(a.dataset.offset)&&i<parseInt(a.dataset.offset)&&!1===a.classList.contains("completed-mission")&&(J(a.dataset.mission,document.querySelector("."+a.dataset.mission+"-mission-item"),n),a.classList.add("completed-mission"),t.classList.add("no-point"),"true"===a.dataset.removable&&(a.remove(),j(Ne(a.className),"point",0,2e3,"",!0)),"yes"===t.dataset.disappear&&(t.remove(),j(n,"point",0,2e3,"",!0)))}const o=`${OrbemOrder.siteRESTURL}/save-drag/`,s={slug:n,top:t.style.top.replace("px",""),left:t.style.left.replace("px","")};fetch(o,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":OrbemOrder.orbemNonce},body:JSON.stringify(s)}).then((e=>{if(!e.ok)throw new Error("Network response was not ok "+e.statusText)}))}else!function(){const e=document.querySelector(".dragme"),t=document.querySelector("#map-character"),n=document.querySelector(".currently-dragging"),a=t.querySelector(".map-character-icon.engage");let o;if(e){window.allowHit=!1;const s=parseInt(e.style.top.replace("px","")),r=parseInt(e.style.left.replace("px","")),c=parseInt(t.style.top.replace("px",""))+450,i=parseInt(t.style.left.replace("px",""))+450,l=s<c,d=r<i,u=l?c-s:s-c,m=d?i-r:r-i,p=s<c-50,g=r<i-50,y=p?c-50-s:s-(c-50),f=g?i-(45+a.offsetWidth/2)-r:r-(i-(55+a.offsetWidth/2));if(window.dragTop={offset:u,higher:l},window.dragLeft={offset:m,left:d},o=p&&y>=e.offsetHeight?"up":o,o=!1===p&&y>=a.offsetHeight?"down":o,o=g&&f>=e.offsetWidth?"left":o,o=!1===g&&f>=a.offsetWidth?"right":o,void 0===o)return window.dragTop=!1,void(window.dragLeft=!1);n&&n.classList.remove("currently-dragging"),e.classList.add("currently-dragging"),window.isDragging="-drag",window.draggingDirection=o}else window.dragTop=!1,window.dragLeft=!1}()}));const s=document.querySelectorAll(".spell"),r=document.getElementById("weapon"),c=document.querySelector(".map-weapon");window.currentWeapon=C!==c.dataset.weapon?"-"+c.dataset.weapon:"",s&&r&&(s.forEach((e=>{e.addEventListener("click",(()=>{const t=document.querySelector(".spell.engage"),n=document.querySelector("#weapon"),a=document.querySelector(".map-weapon"),o=e.getAttribute("data-type"),s=e.getAttribute("title"),r=e.getAttribute("data-value");n.classList.remove("engage"),t&&t.classList.remove("engage"),e.classList.add("engage"),a.className="map-weapon",a.classList.add(o),a.classList.add(s),a.classList.add("spell"),a.setAttribute("data-value",r),window.weaponTime=r}))})),r.addEventListener("click",(()=>{const e=document.querySelector(".spell.engage"),t=document.querySelector(".map-weapon");e&&(e.classList.remove("engage"),t.className="map-weapon",window.weaponTime=400),r.classList.add("engage")})));const i=document.querySelector(".character-item > img");i?(ue(),i.classList.remove("engage")):ue();const l=document.querySelectorAll("#explore-points .point-bar");l&&l.forEach((e=>{const t=e.getAttribute("data-amount"),n=e.querySelector(".gauge");if(n&&!1===e.classList.contains("point-amount")&&!1===e.classList.contains("money-amount"))e.setAttribute("data-amount",t),n.style.width=t+"px";else if(!0===e.classList.contains("point-amount")){const a=$e(t);OrbemOrder.levelMaps&&(window.nextLevelPointAmount=JSON.parse(OrbemOrder.levelMaps)[a],e.setAttribute("data-amount",t),n.style.width=z(t))}else!0===e.classList.contains("money-amount")&&(e.dataset.amount=t,e.querySelector(".money-text").textContent=t)})),document.body.style.position="fixed";const d=document.getElementById("engage-explore"),u=document.getElementById("try-engage-explore"),m=document.querySelectorAll("#login-register"),p=document.querySelector(".non-login-warning"),g=document.querySelector(".game-login-create-container");d&&d.addEventListener("click",(function(){me()})),u&&u.addEventListener("click",(function(){p.classList.add("engage")})),m&&m.forEach((e=>{e.addEventListener("click",(function(){g.classList.add("engage"),p.classList.remove("engage")}))})),R(),P();const y=document.getElementById("new-explore");y&&y.addEventListener("click",(async()=>{window.confirm("Are you sure you want to start a new game? All your previously saved data will be lost."),await async function(){const e=`${OrbemOrder.siteRESTURL}/resetexplore/`;fetch(e,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":OrbemOrder.orbemNonce},body:JSON.stringify({})}).then((e=>{if(!e.ok)throw new Error("Network response was not ok "+e.statusText)}))}(),setTimeout((()=>{window.location.href=OrbemOrder.gameURL}),1e3)}))}));const Y=function(){let e=!1;return function(t,n){if(n&&t&&Pe(t,n,0)&&!1===e){if("explore-enemy"===n.dataset.genre&&!1===t.classList.contains("protection")){var a;const e=n.dataset.health,o=n.dataset.healthamount,s=n.dataset.mission;let r=!0===t.classList.contains("heavy-engage")?"heavy":"normal";r=!0===t.classList.contains("charge-attack-engage")?"charged":r;const c=parseInt(JSON.parse(t.dataset.strength)[r])+window.attackMultiplier,i=0<=e-c?e-c:0,l=null!==(a=n.dataset.weapon)&&void 0!==a?a:"";if((""!==l&&t.dataset.weapon===l||""===l)&&n.setAttribute("data-health",i),"boss"===n.getAttribute("data-enemy-type")&&(i<=.75*o&&!1===L?(L=!0,ae(n)):i<=.5*o&&!1===x?(x=!0,ae(n)):i<=.25*o&&!1===q&&(q=!0,ae(n))),0===i){clearInterval(window.shooterInt),clearInterval(window.runnerInt),n.remove();const e=Ne(n.className),t=`${OrbemOrder.siteRESTURL}/enemy/`,a={health:0,position:e};fetch(t,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":OrbemOrder.orbemNonce},body:JSON.stringify(a)}).then((e=>{if(!e.ok)throw new Error("Network response was not ok "+e.statusText)})),s&&we(s)&&J(s,n,s)}}e=!0,setTimeout((()=>{e=!1}),1e3)}}}(),Z=function(){window.runningPointFunction=!1;let e=!1;return function(t,n,o,s){var r;!function(){const e=document.querySelector(".game-container");e&&(e.dataset.fadeout="true")}(),window.previousCutsceneArea=""===window.previousCutsceneArea?null!==(r=OrbemOrder.previousCutsceneArea)&&void 0!==r?r:"":window.previousCutsceneArea,ze(!1),window.allowMovement=!1,clearInterval(window.shooterInt),clearInterval(window.runnerInt);const c=document.querySelectorAll(".game-container > .explainer-container, .game-container > .explainer-trigger");c&&c.forEach((e=>{e.remove()}));const i=document.querySelector(".right-bottom-devmode"),l=document.querySelector(".dev-mode-menu");l&&i&&(l.remove(),i.remove());const d=document.querySelector(".explore-item-list");d&&(d.innerHTML="");const u=document.querySelector(".default-map");if(u&&u.remove(),!1===e){const n=`${OrbemOrder.siteRESTURL}/area/`;let r="";OrbemOrder.musicNames&&(r=JSON.parse(OrbemOrder.musicNames)[t]);const c={position:t};fetch(n,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":OrbemOrder.orbemNonce},body:JSON.stringify(c)}).then((e=>{if(!e.ok)throw new Error("Network response was not ok "+e.statusText);return e.json()})).then((e=>{let n=e;n=n.data;const c=document.getElementById("map-item-styles"),i=document.querySelector(".site-main"),l=document.querySelector("head");let d="";n["dev-mode"]&&""!==n["dev-mode"]&&(d=n["dev-mode"]),""!==d&&(i.innerHTML=d+i.innerHTML),c&&c.remove();const m=document.createElement("style");m.id="map-item-styles",m.innerHTML=n["map-item-styles-scripts"];const p=document.querySelector(".missions-content");if(p&&(p.innerHTML=n["map-missions"],""!==window.nextAreaMissionComplete)){const e=document.querySelector("."+window.nextAreaMissionComplete+"-mission-item");e&&(e.style.textDecoration="line-through",setTimeout((()=>{X(e),e.remove()}),500))}l&&l.append(m),u&&setTimeout((()=>{const e=document.querySelector(".game-container"),t=document.createElement("div");t.className="default-map",t.dataset.starttop=n["start-top"],t.dataset.startleft=n["start-left"],t.innerHTML=n["map-explainers"]+n["map-items"]+n["map-cutscenes"]+n.minigames+n["map-svg"]+n["map-communicate"],"yes"===n["is-cutscene"]&&(t.dataset.iscutscene="yes"),e.innerHTML=n["menu-explainers"]+n["fullscreen-explainers"]+e.innerHTML+t.outerHTML,R(),P();const o=document.querySelector(".characters-content");if(o){o.innerHTML=n["map-characters"],0<o.querySelectorAll(".character-item").length&&(document.getElementById("characters").style.display="block"),B(),Je(),(0,a.S)();const e=document.getElementById("characters"),t=e.querySelector(".close-settings");t&&t.addEventListener("click",(()=>{e.classList.remove("engage")}))}const s=document.querySelectorAll('.path-onload[data-path]:not([data-path=""]), [data-wanderer="yes"]');s&&s.forEach((e=>{M(e,!1)})),pe(),ge(),Ee();const r=document.querySelectorAll(".map-cutscene .wp-block-orbem-paragraph-mp3:first-of-type, .map-communicate .message-wrapper .wp-block-orbem-paragraph-mp3");if(r&&r.forEach((e=>{e.classList.add("engage")})),""!==window.previousCutsceneArea){Ie(document.querySelectorAll("[data-removeaftercutscene]"),window.previousCutsceneArea);const e=document.querySelectorAll("[data-showaftercutscene="+window.previousCutsceneArea+"]");e&&(e.forEach((e=>{y.push(Ne(e.className)),e.classList.add("no-point")})),be(I,y))}if("yes"===n["is-cutscene"]){const e=Ne(document.querySelector(".map-cutscene").className);qe(e,!0),window.previousCutsceneArea=e,xe(window.previousCutsceneArea)}else Oe();const c=document.querySelectorAll('[data-crewmate="yes"]');if(0<c.length){let e=0;const t=setInterval((()=>{e===c.length-1&&clearInterval(t),function(e){const t=`${OrbemOrder.siteRESTURL}/add-character/`,n={slug:e};fetch(t,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":OrbemOrder.orbemNonce},body:JSON.stringify(n)}).then((e=>{if(!e.ok)throw new Error("Network response was not ok "+e.statusText)}))}(Ne(c[e].className)),e++}),1e3)}ue()}),700),setTimeout((()=>{const e=document.querySelector(".game-container"),a=document.getElementById("map-character"),c=document.querySelector(".map-weapon");s&&(n["start-top"]=JSON.parse(s).top,n["start-left"]=JSON.parse(s).left),a.style.top=n["start-top"]+"px",a.style.left=n["start-left"]+"px",a.className=n["start-direction"]+"-dir",a.scrollIntoView({behavior:"instant",block:"center",inline:"center"}),Ce(a,n["start-direction"],!1),e.className="game-container "+t,e.style.backgroundImage="url("+o+")",I=t,te(r,t),window.allowMovement=!0,c.style.display="block",(void 0!==OrbemOrder.exploreAbilities&&0<OrbemOrder.exploreAbilities.length&&OrbemOrder.exploreAbilities.includes("transportation")||n["explore-ability"].includes("transportation"))&&De()}),100)})),e=!0,setTimeout((()=>{e=!1}),1e3)}}}(),G=function(){let e=!1;return function(t){const n=t.getAttribute("data-id"),a=document.querySelector(".storage-item.engage");if(a&&a.classList.remove("engage"),t.classList.add("engage"),!1===e){const t=`${OrbemOrder.siteRESTURL}/get-item-description/`,a={id:n};fetch(t,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":OrbemOrder.orbemNonce},body:JSON.stringify(a)}).then((e=>{if(!e.ok)throw new Error("Network response was not ok "+e.statusText);return e.json()})).then((e=>{const t=document.getElementById("item-description");t&&(t.innerHTML="");let n=e;n=n.data;const a=document.querySelector(".retrieval-points #item-description"),o=document.querySelector(".storage-item.engage"),s=document.createElement("button");s.classList.add("storage-item-button"),s.textContent="Equip";const r=document.createElement("button");r.textContent="Unequip",r.classList.add("storage-item-button");const c=document.createElement("button");c.textContent="Drop",c.classList.add("storage-item-button"),a.innerHTML=n,a.appendChild(c),a.appendChild(r),a.appendChild(s);const i=a.querySelector(".use-button"),l=o.getAttribute("data-id"),d=o.getAttribute("title"),u=o.getAttribute("data-value"),m=o.getAttribute("data-type");i&&o&&100>ee(m)&&i.addEventListener("click",(()=>{Re(o,d),a.innerHTML=""})),c&&c.addEventListener("click",(()=>{V(d,m),a.innerHTML="";const e=document.getElementById("item-description");e&&(e.innerHTML="")})),s&&s.addEventListener("click",(()=>{const e=document.querySelector(".map-character-icon.engage").dataset.currentchar,t=document.querySelector(".storage-item.engage");if(t&&t.dataset.character===e||t&&(""===t.dataset.character||void 0===t.dataset.character||null===t.dataset.character)){const e=t.querySelector("img"),n=document.querySelector(".map-weapon"),a=document.querySelector(".weapon-content img");n&&a&&(a.src=e.src,n.dataset.weapon=t.title,n.dataset.strength=t.dataset.strength),t.classList.add("equipped"),t.classList.add("being-equipped")}Q(!1),a.innerHTML="",U(m,l,u,!1,t.title)})),r&&r.addEventListener("click",(()=>{const e=document.querySelector(".storage-item.engage");e&&(e.classList.remove("equipped"),e.classList.add("unequip")),Q(!0),a.innerHTML="",U(m,l,u,!0,e.title)}))})),e=!0,setTimeout((()=>{e=!1}),1e3)}}}();function K(e){if(e){const t=e.querySelector("img"),n=document.querySelector(".map-weapon"),a=document.querySelector(".weapon-content img"),o=n.querySelector("img");n&&a&&(o.src=t.src,a.src=t.src,n.dataset.weapon=e.title,o.style.width=e.dataset.width+"px",o.style.height=e.dataset.height+"px",n.dataset.strength=e.dataset.strength,n.dataset.projectile=e.dataset.projectile,window.currentWeapon=C!==e.title?"-"+e.title:"")}}function Q(e){const t=document.querySelector('.storage-item.being-equipped[data-type="gear"]'),n=document.querySelector("#explore-points .health-amount"),a=document.querySelector("#explore-points .mana-amount");let o=parseInt(a.dataset.amount),s=parseInt(n.dataset.amount),r=parseInt(a.style.width.replace("px","")),c=parseInt(n.style.width.replace("px",""));if(t&&!1===e){const e=t.getAttribute("data-value"),n=t.getAttribute("data-subtype");"health"===n&&(s+=parseInt(e),c+=parseInt(e)),"mana"===n&&(o+=parseInt(e),r+=parseInt(e))}else if(t&&!1!==e){const e=document.querySelector('.storage-item.unequip[data-type="gear"]'),t=e.getAttribute("data-value"),n=e.getAttribute("data-subtype");"health"===n&&(s-=parseInt(t),c-=parseInt(t)),"mana"===n&&(o-=parseInt(t),r-=parseInt(t))}t&&(n.style.width=c+"px",n.setAttribute("data-amount",s),n.querySelector(".gauge").style.width=s+"px",a.style.width=r+"px",a.setAttribute("data-amount",o),a.querySelector(".gauge").style.width=o+"px");const i=document.querySelector(".being-equipped"),l=document.querySelector(".unequip");i&&i.classList.remove("being-equipped"),l&&l.classList.remove("unequip")}function ee(e){const t=document.querySelector(`#explore-points .${e}-amount`);return parseInt(t.getAttribute("data-amount"))}function te(e,t){if(!e||""===e)return;const n=document.createElement("audio");n.setAttribute("loop",""),n.src=e,n.id=t,document.body.appendChild(n);const a=document.getElementById("music-volume");a&&n&&(n.volume=a.value/100),window.currentMusic&&window.currentMusic.pause(),n&&(n.play(),window.currentMusic=n)}function ne(e,t){const n=e.getAttribute("data-enemy-type");t&&t.remove(),"shooter"===n&&oe(e),"runner"===n&&(window.runnerInt=setInterval((()=>{const t=Ne(e.className),n=document.querySelector("."+t+"-map-item"),a=document.querySelectorAll(".default-map svg rect, .protection");let o=parseInt(n.style.left,10),s=parseInt(n.style.top,10);const r=document.getElementById("map-character");if(o<parseInt(r.style.left.replace("px",""))+400?o+=1:o-=1,s<parseInt(r.style.top.replace("px",""))+400?s+=1:s-=1,a&&n){const e=Me(a,n.getBoundingClientRect(),s,o,!0,!1);n.style.left=e.left+"px",n.style.top=e.top+"px"}}),20)),"boss"===n&&(ae(e),g=setInterval((()=>{const e=document.querySelector(".pulse-wave-container");re(e,document.querySelector(".map-character-icon.engage"),document.querySelector(".game-container"))?(E=!0,window.theHazardValue=e.dataset.value):E=!1}),20))}function ae(e){const t=e.dataset.waves.split(",");t&&(t.forEach((t=>{e.classList.remove(t+"-wave-engage")})),e.classList.add(t[S]+"-wave-engage"),"pulse-wave"===t[S]?d=setInterval((()=>{e.classList.toggle("pulse-in")}),13e3):d&&(clearInterval(d),e.classList.remove("pulse-in")),"projectile"===t[S]?oe(e):clearInterval(l)),S++}function oe(e){const t=e.dataset.enemyspeed;l=window.shooterInt=setInterval((()=>{const n=document.querySelector(".map-character-icon.engage"),a=n.getBoundingClientRect().left+n.width/2,o=n.getBoundingClientRect().top+n.width/2,s=e.querySelector(".projectile");s&&se(s,a,o,e,t,!1,".projectile","no")}),5e3)}function se(e,t,n,a,o,s,r,c){const i=e.cloneNode(!0);i.classList.remove("engage"),i.style.transition="",!0!==s&&"no"===c?function(e,t,n,a,o){let s,r;const c=e.getBoundingClientRect(),i=document.getElementById("map-character"),l=de(o),d=de(i);le(d.x,d.y,l.x,l.y,e,a);const u=Math.atan2(n-c.top,t-c.left),m=t+800*Math.cos(u),p=n+800*Math.sin(u);s=m-c.left,r=p-c.top,e.style.transform="translate("+s+"px, "+r+"px)"}(e,t,n,o,a):!0===s?(e.classList.remove("map-weapon"),e.classList.add("magic-weapon"),ie(e,t,n),a=document.querySelector(".game-container")):"yes"===c&&(ie(e,t,n),a=document.querySelector(".game-container"));const l=setInterval((function(){const e=a.querySelector(r);let t=document.querySelectorAll(".default-map svg rect, .protection, .map-character-icon.engage, #map-weapon img");!0!==s&&"yes"!==c||(t=document.querySelectorAll(".default-map svg rect, .enemy-item, .map-item")),t&&e&&function(e,t){const n=document.querySelector(".game-container");requestAnimationFrame((function a(){if(document.body.contains(e)){for(const a of t)if(re(e,a,n)){if(!0===a.classList.contains("map-character-icon")&&!1===e.classList.contains("map-weapon")){const t=parseInt(e.dataset.value),n=document.querySelector("#explore-points .health-amount"),a=parseInt(n.getAttribute("data-amount"));if(n&&0<=a){const e=a>=t?a-t:0;Xe(),$(e,"health","projectile",!1,"")}}e.remove(),window.weaponConnection=!0}requestAnimationFrame(a)}}))}(e,t)}),20);setTimeout((()=>{if(!0===s||"true"===c){const e=document.getElementById("map-character").className.replace("-dir","");i.setAttribute("data-direction",e)}a.appendChild(i),e.remove(),window.weaponConnection=!0,clearInterval(l)}),4500)}function re(e,t,n){const a=ce(e,n),o=ce(t,n);return!(a.right<o.left||a.left>o.right||a.bottom<o.top||a.top>o.bottom)}function ce(e,t){const n=e.getBoundingClientRect(),a=t.getBoundingClientRect();return{top:n.top-a.top,left:n.left-a.left,width:n.width,height:n.height,right:n.right-a.left,bottom:n.bottom-a.top}}function ie(e,t,n){window.weaponConnection=!1,e.style.transition="all 3s",e.style.left=t+"px",e.style.top=n+"px"}function le(e,t,n,a,o,s){const r=.075*Math.hypot(e-n,t-a)*s;let c="down";const i=Math.abs(t-a),l=Math.abs(e-n);return o.style.transition="all "+r+"ms linear 0s",t>a&&i>l?c="up":t<a&&i>l?c="down":e<n&&l>i?c="right":e>n&&l>i&&(c="left"),c}function de(e){const{top:t,left:n,width:a,height:o}=e.getBoundingClientRect();return{x:n+a/2,y:t+o/2}}function ue(){["health","mana","point","gear","weapons","money"].forEach((e=>{const t=void 0!==OrbemOrder.explorePoints[e]?OrbemOrder.explorePoints[e].positions:[];t&&t.forEach((e=>{const t=parseInt(e)>0,n=t?null:document.querySelector("."+e+"-map-item"),a=t?null:document.querySelector("."+e+"-map-cutscene"),o=t?null:document.querySelector("."+e+"-explainer-trigger-map-item"),s=t?null:document.querySelector("."+e+"-materialize-item-map-item"),r=t?null:document.querySelector("."+e+"-drag-dest-map-item"),c=document.getElementById(e+"-t");if(c){const t=document.getElementById(e),n=t.parentNode;t&&(t.classList.add("engage"),c.remove()),n&&!1===n.classList.contains("dependent")&&n.classList.add("dependent")}a&&a.classList.add("been-viewed"),o&&o.classList.add("already-hit"),n&&(function(e){return void 0!==e.dataset.timer&&null!==e.dataset.timer||"explore-character"===e.dataset.genre||"true"===e.dataset.hazard||"true"===e.dataset.collectable||"true"===e.dataset.breakable&&"no"!==e.dataset?.disappear||"true"===e.dataset.removable&&"no"!==e.dataset?.disappear||"true"===e.dataset.draggable&&"yes"===e.dataset?.disappear||void 0!==e.dataset?.removeaftercutscene}(n)&&(n.remove(),s&&s.remove()),r&&"true"===r.dataset.removable&&r.remove(),"no"===n.dataset?.disappear&&ve(n),n.classList.add("no-point"))}));const n=document.querySelectorAll(".map-item-modal.graeme"),a=document.querySelectorAll(".map-item-modal");a&&a.forEach((e=>{e.classList.remove("engage")})),n&&n.forEach((e=>{e.classList.add("engage")}))}))}function me(){var e;const t=document.querySelector(".game-container"),n=document.querySelector(".touch-buttons");window.previousCutsceneArea=null!==(e=OrbemOrder.previousCutsceneArea)&&void 0!==e?e:"";const a=document.querySelectorAll(".map-cutscene .wp-block-orbem-paragraph-mp3:first-of-type, .map-communicate .wp-block-orbem-paragraph-mp3");a&&a.forEach((e=>{e.classList.add("engage")})),ze(!1),Ee(),window.weaponConnection=!0,window.allowHit=!0,window.allowIndicate=!0,window.attackMultiplier=0,window.runningPointFunction=!1,window.moveSpeed=3,window.currentCharacterAutoDirection="",B(),pe();const o=document.getElementById("characters"),s=!!o&&o.querySelectorAll(".character-item");o&&0<s.length&&(o.style.display="block"),document.querySelector(".explore-overlay")&&document.querySelector(".explore-overlay").remove(),document.body.style.position="unset",n&&n.classList.add("do-mobile");let r="";OrbemOrder.musicNames&&I&&(r=JSON.parse(OrbemOrder.musicNames)[I]),te(r,I);const c=document.getElementById("explore-points"),l=document.getElementById("missions");c&&(c.style.opacity="1"),l&&(l.style.opacity="1");const d=document.getElementById("key-guide");Ue(d,"engage"),Ue(n,"engage"),window.buttonShow=setInterval((function(){Ue(n,"engage"),Ue(d,"engage")}),1e4);const u=document.querySelectorAll('.path-onload[data-path]:not([data-path=""]), [data-wanderer="yes"]');if(u&&u.forEach((e=>{M(e,!1)})),ge(),function(){let e=200,t=!1,n=!1;document.addEventListener("keydown",(e=>{const t=document.querySelector(".map-weapon");!1!==window.allowHit&&(!0===["ShiftLeft","ShiftRight"].includes(e.code)&&(v=!0),"Space"===e.code&&(b=!0,i=setTimeout((()=>{!0===b&&(t.classList.add("charge-engage"),n=!0)}),1e3)))})),document.addEventListener("keyup",(a=>{const o=document.querySelector(".map-weapon"),s=C===o.dataset.weapon?"":"-"+o.dataset.weapon,r="top"===o.dataset.direction?"up":o.dataset.direction,c=document.querySelector("#map-character");let l=c.querySelector(".map-character-icon.engage");const d=c.querySelector(`#${window.mainCharacter}-${r}-punch${s}`);if(!1!==window.allowHit){const u=document.querySelector("#explore-points .mana-amount"),m=u?u.dataset.amount:0;if(!0===["ShiftLeft","ShiftRight"].includes(a.code)&&(v=!1),"Space"===a.code&&(b=!1,clearTimeout(i),o&&!1===t)){const a=o.classList.contains("spell");if(e=o.classList.contains("protection")?8e3:100,"true"===o.dataset.projectile||!0===a&&0<m||!1===a&&!1===n){switch(o.classList.add("engage"),r){case"up":T=310;break;case"down":T=490;break;case"left":A=350;break;case"right":A=450}l&&(l.classList.add("punched"),d.classList.add("engage"))}if(0<m&&!0===a){const e=o.getAttribute("data-value");u.setAttribute("data-amount",parseInt(m)-parseInt(e)),u.classList.add("engage");let t=parseInt(m)-parseInt(e);t=0>t?0:t,$(t,"mana","magic",!1,""),setTimeout((()=>{u.classList.remove("engage")}),500)}if("true"===o.dataset.projectile||!0===a||!1===a&&!1===t&&!1===v)setTimeout((()=>{if(!1===o.classList.contains("heavy-engage"))switch(o.classList.remove("engage"),l.classList.remove("punched"),d.classList.remove("engage"),r){case"up":case"down":T=400;break;case"left":case"right":A=400}}),e);else if(!0===v){const e=c.querySelector(`#${window.mainCharacter}-${r}-punch${s}`);o.classList.add("heavy-engage"),t=!0,setTimeout((()=>{switch(t=!1,o.classList.remove("heavy-engage"),o.classList.remove("engage"),l.classList.remove("punched"),e.classList.remove("engage"),r){case"up":case"down":T=400;break;case"left":case"right":A=400}v=!1}),500)}if(0<m&&o&&("yes"===o.dataset.projectile||!0===a)){let e=parseInt(o.style.left.replace("px","")),t=parseInt(o.style.top.replace("px",""));const n=!0===a?".magic-weapon":".map-weapon";switch(o.getAttribute("data-direction")){case"down":t+=1e4;break;case"top":t-=1e4;break;case"left":e-=1e4;break;case"right":e+=1e4}se(o,e,t,document,2,a,n,o.dataset.projectile)}!0===n&&(n=!1,o.classList.remove("charge-engage"),o.classList.add("charge-attack-engage"),setTimeout((()=>{o.classList.remove("charge-attack-engage"),l.classList.remove("punched"),d.classList.remove("engage")}),700))}}else if("Space"===a.code){const e=document.querySelector(".indicator-icon");if(e&&!0===e.classList.contains("engage")){const t=e.dataset?.cutscene,n=e.dataset?.sign,a=e.dataset?.minigame,o=!!a&&document.querySelector("[data-minigame="+a+"]");t&&""!==t&&(qe(t,!1),e.dataset.cutscene=""),n&&""!==n&&(function(e){const t=document.querySelector("."+e+"-map-item");t.classList.add("open-up"),document.addEventListener("click",(()=>{t.classList.remove("open-up")}),{once:!0}),document.addEventListener("keydown",(function e(n){"Space"===n.code&&(t.classList.remove("open-up"),document.removeEventListener("keydown",e))}))}(n),e.dataset.sign=""),a&&o&&""!==a&&(function(e){const t=document.querySelector("."+e.dataset.minigame+"-minigame-item");if(t){const n=t.dataset.music;let a=!1;const o=t.dataset.mission;let s=!1;if(o&&""!==o&&(s=document.querySelector("."+o+"-mission-item"),s&&(a=s.classList.contains("engage"))),a){window.allowMovement=!1,t.classList.add("engage"),e.classList.add("hit"),n&&""!==n&&te(n,o);let a=null,r=0,c=0;const i=e=>{if(e.preventDefault(),a=e.target,a){const t=a.getBoundingClientRect();r=e.clientX-t.left,c=e.clientY-t.top,e.dataTransfer.setData("text/plain",""),document.addEventListener("mousemove",l)}},l=e=>{if(a){const n=t.getBoundingClientRect(),o=e.clientX-n.left,s=e.clientY-n.top;a.style.position="fixed",a.style.zIndex="9",a.style.left=o-r+"px",a.style.top=s-c+"px"}},d=()=>{if(a){a=null,document.removeEventListener("mousemove",l);const e=document.querySelectorAll(".minigame");e&&e.forEach((e=>{const t=e.querySelector(".computer-chip"),n=t.querySelectorAll("ellipse"),a=e.querySelector(".draggable-images");function r(e,t){const n=e.getBoundingClientRect(),a=t.getBoundingClientRect();return!(n.right<a.left||n.left>a.right||n.bottom<a.top||n.top>a.bottom)}(function(e,t){for(let n of t){let t=!1;for(let a of e)if(r(a,n)){t=!0;break}if(!t)return!1}return!0})(a.querySelectorAll(".minigame-draggable-image"),n)&&(t.style.display="none",a.style.display="none",function(e,t,n){const a=n.querySelector(".programming-output"),o=n.querySelector(".minigame-programming"),s=n.querySelector(".programming-subject"),r=a.querySelector("textarea");if(o&&s&&(o.classList.add("engage"),s.classList.add("engage")),a&&s&&r){a.prepend(s),r.focus();const o=function(e){let t="";return e.split("").forEach((e=>{let n=e.charCodeAt(0).toString(2);t+=("00000"+n).slice(-5).concat("")})),t}(s.querySelector("strong").textContent);r.addEventListener("keyup",(s=>{if(13===s.which){const s=a.querySelector("textarea");parseInt(s.value)===parseInt(o)&&(J(e,t,e),n.classList.remove("engage"),window.allowMovement=!0,function(e){const t=Ne(e.className),n=document.querySelector('.map-cutscene[data-minigame="'+t+'"]');n&&qe(Ne(n.className),!1);let a="";OrbemOrder.musicNames&&(a=JSON.parse(OrbemOrder.musicNames)[I]),e.dataset.music&&""!==e.dataset.music&&a&&te(a,I)}(n))}}))}}(o,s,e))}))}};document.querySelectorAll(".minigame-draggable-image").forEach((e=>{e.addEventListener("dragstart",i),e.addEventListener("mouseup",d)}))}}}(o),e.dataset.minigame="")}}}))}(),Ae(),"yes"===document.querySelector(".default-map").dataset.iscutscene&&I){const e=Ne(document.querySelector(".map-cutscene").className);window.previousCutsceneArea=e,xe(window.previousCutsceneArea),qe(e,!0)}if(""!==window.previousCutsceneArea){Ie(document.querySelectorAll("[data-removeaftercutscene]"),window.previousCutsceneArea);const e=document.querySelectorAll("[data-showaftercutscene="+window.previousCutsceneArea+"]");e&&(e.forEach((e=>{y.push(Ne(e.className)),e.classList.add("no-point")})),be(I,y))}Je(),t&&(t.style.display="block");const m=document.getElementById("map-character");m&&m.scrollIntoView({behavior:"instant",block:"center",inline:"center"}),setTimeout((()=>{Oe()}),1e3)}function pe(){const e=document.querySelectorAll(".materialize-item-trigger");e&&e.forEach((e=>{const t=Ne(e.className),n=document.querySelector("."+t+"-map-item"),a=document.querySelector("."+t+"-drag-dest-map-item");n&&(n.style.display="none"),a&&(a.style.display="none")}))}function ge(){const e=document.querySelectorAll(".mission-list .mission-item");e&&e.forEach((e=>{const t=e.dataset.blockade,n=Ne(e.className),a=document.querySelectorAll('[data-materializemission="'+n+'"]');if(a&&a.forEach((e=>{e.style.display="none"})),t&&""!==t){const n=JSON.parse(t);if("0"!==n.height){const t=document.createElement("div"),a=e.className.replace("mission-item ",""),o=document.querySelector(".default-map");t.className="wp-block-group map-item is-layout-flow wp-block-group-is-layout-flow "+a+"-blockade",t.style.top=n.top+"px",t.style.left=n.left+"px",t.style.width=n.width+"px",t.style.height=n.height+"px",t.dataset.genre="blockade",t.id=e.id,t.draggable=!0,!1===e.classList.contains("engage")&&!0===e.classList.contains("next-mission")&&(t.style.display="none"),o&&o.append(t)}}}))}function ye(e,t,n,a,o,s){const c=document.querySelector(".game-container"),i=document.querySelector("#map-character");let l=i.querySelector(".map-character-icon.engage");const d=document.querySelectorAll('.map-item:not(.drag-dest), .projectile, .enemy-item, [data-hazard="true"]');let m=document.querySelector(".map-weapon");const g=document.querySelector(".magic-weapon"),f=document.querySelector(".game-container").className.replace("game-container ",""),w=i.querySelector(".misc-gauge-wrap");if(g&&(m=g),0<d.length&&!1===window.noTouch&&d.forEach((e=>{let t=Ne(e.className);e.classList.contains("enemy-item")&&Y(m,e);const n=document.querySelector("."+t+"-drag-dest-map-item");let a=!1;n&&!1===e.classList.contains("no-point")&&(a=document.querySelector("."+n.dataset.mission+"-mission-item"),null===a&&e.classList.add("no-point"));const o=document.querySelector(".indicator-icon"),s=Ne(e.className),c=document.querySelector(`.map-cutscene[data-character="${s}"]`),d={offsetLeft:i.offsetLeft+(400-l.offsetWidth/2),offsetWidth:l.offsetWidth,offsetTop:i.offsetTop+(400-l.offsetHeight/2),offsetHeight:l.offsetHeight};if(e&&l&&Pe(d,e,5)?("explore-character"===e.dataset.genre&&""!==e.dataset.path&&(e.dataset.canmove="false",!document.getElementById(c.id+"-t")&&c&&!1===c.classList.contains("been-viewed")&&"engagement"!==c.dataset.triggertype&&qe(c,!1)),!0===e.classList.contains("communicate-trigger")&&function(e,t){const n=document.querySelector("."+e+"-map-communicate"),a=n.parentNode;a.classList.add("notify"),t&&(t.remove(),j(n.id,"communicate",a.id,2e3,"",!1)),n.classList.add("engage")}(e?.dataset.triggee,e)):"false"===e.dataset?.canmove&&(e.dataset.canmove="true"),e&&l&&Pe(d,e,0)){if("explore-sign"===e.dataset.genre&&!1===e.classList.contains("engage")&&(Se(e,!1,!1,!1),e.classList.add("engage"),window.allowHit=!1),!0===e.classList.contains("no-point")&&void 0!==e.dataset?.minigame&&(Se(e,!1,!1,!0),e.classList.add("engage")),"explore-area"===e.getAttribute("data-genre"))return void Te(e,"false");if("true"===e.dataset.hazard&&!1===he(e,i,"hazard")){if(100<=N||0===N){var g;const t=e.dataset.value,n=ee("health")-parseInt(t);Xe(),$(n,"health","hazard",!1,""),fe(25,null!==(g=e.closest(".enemy-item"))&&void 0!==g?g:e,i),N=0}N++}else if("true"===e.dataset.hazard&&!0===he(e,i,"hazard")){w&&w.classList.add("engage");const t=w.querySelector(".misc-gauge");var h;window.hazardTime<=N?(E=!0,window.theHazardValue=e.dataset.value,k=null!==(h=e.closest(".enemy-item"))&&void 0!==h?h:e,t.style.width="100%",w.classList.remove("engage")):t.style.width=(window.hazardTime-N)/window.hazardTime*100+"%",N++}if(n&&(a=document.querySelector("."+n.dataset.mission+"-mission-item")),"true"===e.dataset.draggable&&!1===e.classList.contains("dragme")&&!document.querySelector(".dragme")&&he(e,i,"strength")&&a&&e.classList.add("dragme"),"true"===e.dataset.trigger&&!1===e.classList.contains("cutscene-trigger")){const t=document.querySelector("."+e.dataset.triggee);t&&"explore-enemy"===e.dataset.genre&&ne(t,e)}if(!0===e.classList.contains("explainer-trigger")&&!1===e.classList.contains("already-hit")){const t=document.querySelector("."+e.dataset.triggee+"-explainer-item"),n=e=>{("keydown"===e.type&&"Space"===e.code||"click"===e.type)&&(window.allowMovement=!0,window.allowHit=!0,t.classList.remove("show-explainer"),document.removeEventListener("keydown",n))};if(t){var v;t.classList.add("show-explainer"),t.style.zIndex="10",e.classList.add("already-hit"),window.allowMovement=!1,window.allowHit=!1,je(Array.from(t.querySelector("p").childNodes).filter((e=>e.nodeType===Node.TEXT_NODE)).map((e=>e.textContent)).join(""),i.dataset.voice,null!==(v=document.getElementById(t.id+"-s"))&&void 0!==v&&v);const a=t.querySelector("img");if(a){const e=parseInt(a.dataset.rotate);let t=!1,n=!1,o=!1;if(a&&e&&0<e&&(0<e&&90>=e&&(t=`rotate(${e}deg) translate( 10px, -10px )`,n=`rotate(${e}deg) translate( 10px, 10px )`,o=`rotate(${e}deg) translate( 10px, -10px )`),91<e&&180>=e&&(t=`rotate(${e}deg) translate( 0, 10px )`,n=`rotate(${e}deg) translate( -10px, -10px )`,o=`rotate(${e}deg) translate( 0, 10px )`),181<e&&270>=e&&(t=`rotate(${e}deg) translate( -10px, 10px )`,n=`rotate(${e}deg) translate( -10px, -10px )`,o=`rotate(${e}deg) translate( -10px, 10px )`),271<e&&360>=e&&(t=`rotate(${e}deg) translate( -10px, 0 )`,n=`rotate(${e}deg) translate( -10px, -10px )`,o=`rotate(${e}deg) translate( -10px, 0 )`),!1!==t)){const e=[{transform:t},{transform:n},{transform:o}],s={duration:1e3,iterations:1/0};a.animate(e,s)}}document.addEventListener("click",n),document.addEventListener("keydown",n),j(e.dataset.triggee,"point",0,2e3,"",!0)}}!0===e.classList.contains("path-trigger")&&!1===e.classList.contains("already-hit")&&(M(document.querySelector("."+e.getAttribute("data-triggee")),!1),e.remove()),"true"===e.dataset?.collectable&&(e.dataset.mission&&""!==e.dataset.mission&&J(e.dataset.mission,e,t),Le(e),"point"===e.dataset.type&&e.dataset?.value&&0<e.dataset.value&&Re(e,Ne(e.className),!1,e.dataset.value,"")),!0===e.classList.contains("mission-trigger")&&(e.dataset.triggee&&""!==e.dataset.triggee&&J(e.dataset.triggee,e,t),e.remove());const o=e.dataset.triggee;t=o&&""!==o?Ne(o):t;const s=o&&""!==o?document.getElementById(e.id.replace("-t","")):document.querySelector("."+t+"-map-cutscene");if(!1===e.classList.contains("engage")&&s&&!1===s.classList.contains("been-viewed")&&!0===e.classList.contains("cutscene-trigger")&&("engagement"!==e.dataset.triggertype?(e.dataset.mission&&""!==e.dataset.mission&&J(e.dataset.mission,e,t),qe(t,!1),""===t&&be(f,[Ne(e.className)]),e.remove()):(e.classList.add("engage"),Se(document.querySelector("."+s.dataset?.character+"-map-item"),!0,e,!1))),!0===e.classList.contains("materialize-item-trigger")){clearTimeout(r);const t=Ne(e.className),n=document.querySelector("."+t+"-map-item"),a=document.querySelector("."+t+"-drag-dest-map-item");n&&(n.style.display="block"),a&&(a.style.display="block"),y.push(t),r=setTimeout((()=>{be(f,y)}),1e3),e.remove()}"true"===e.getAttribute("data-collectable")&&e.remove(),clearTimeout(u),u=setTimeout((()=>{E=!1,k=!1,N=0,w.classList.remove("engage")}),100)}else!0!==e.classList.contains("engage")&&!0!==e.classList.contains("dragme")||(e.classList.remove("engage"),e.classList.remove("dragme"),o&&(o.classList.remove("engage"),window.allowHit=!0));if(m&&"none"!==m.style.display&&Pe(m,e,0)){const n=Ne(e.className),a=document.querySelector('[data-timertriggee="'+n+'"]'),o=e.dataset?.timertriggee,s=document.querySelector(".start-timer");if((a||void 0!==o)&&s&&!1===e.classList.contains("start-timer")){const n="true"===s.dataset.removable?"":[t,Ne(s.className)];J(e.dataset.mission,e,n),s.style.display="none",e.style.display="none"}else if(a||void 0!==o){e.classList.add("start-timer");const t=void 0!==o?parseInt(e.dataset.timer):parseInt(a.dataset.timer);0<t&&(setTimeout((()=>{e.classList.remove("start-timer")}),1e3*t),function(e){if(!1===O){O=!0;const t=document.createElement("div");t.className="timer-countdown";let n=parseInt(e/1e3).toString();t.style.position="fixed",t.style.left="50%",t.style.transform="translateX(-50%)",t.style.top="1rem",t.style.fontSize="2rem",t.style.zIndex="99999",t.textContent=n;const a=document.querySelector(".game-container");a&&a.appendChild(t),p=setInterval((()=>{const e=document.querySelector(".timer-countdown"),t=parseInt(e.textContent);0!==t&&(n=t),e.textContent=0<n?n-1:0,"0"===e.textContent&&(e.remove(),clearInterval(p),O=!1)}),1e3)}}(1e3*t))}else if(("true"===e.dataset.breakable||"true"===e.dataset.collectable)&&e.dataset.mission&&""!==e.dataset.mission&&he(e,i,"strength")&&null===a&&void 0===o&&we(e.dataset.mission)){const n=document.querySelectorAll(`.map-item[data-mission="${e.dataset.mission}"]`);n&&(t=[],n.forEach((e=>{t.push(Ne(e.className))}))),J(e.dataset.mission,e,t)}"true"===e.getAttribute("data-breakable")&&!1===e.classList.contains("interacted-with")&&!1===e.classList.contains("no-point")&&(Le(e),"point"===e.dataset.type&&Re(e,Ne(e.className),!1,e.dataset.value,""),e.classList.add("interacted-with")),!0!==we(e.dataset.mission)||"true"!==e.dataset.breakable||"explore-sign"===e.dataset.genre||!he(e,i,"strength")||null!==e.dataset.minigame&&void 0!==e.dataset.minigame||null!==e.dataset.disappear&&void 0!==e.dataset.disappear||"no"===e.dataset?.disappear?e&&(b=e,"no"!==b.dataset?.disappear&&"true"===b.dataset.breakable&&"explore-sign"!==b.dataset.genre&&(b.style.display="none"),"no"===b.dataset?.disappear&&ve(b)):e.remove()}var b})),a[37]||a[38]||a[39]||a[40]||a[87]||a[65]||a[68]||a[83]){const e=!0===a[s]?s:parseInt(function(e){for(const t in e)if(e.hasOwnProperty(t)&&true===e[t])return t;return null}(a)),t=window.isDragging;let n,o;if(!1===l.classList.contains("fight-image")&&!0===window.allowMovement)switch(e){case 38:case 87:l.classList.remove("engage"),n=""!==t?window.draggingDirection:"up",o=document.getElementById(window.mainCharacter+"-"+n+t+window.currentWeapon),o&&o.classList.add("engage"),i.className="",i.classList.add("top-dir"),m&&m.setAttribute("data-direction","top");break;case 37:case 65:l.classList.remove("engage"),n=""!==t?window.draggingDirection:"left",o=document.getElementById(window.mainCharacter+"-"+n+t+window.currentWeapon),o&&o.classList.add("engage"),i.className="",i.classList.add("left-dir"),m&&m.setAttribute("data-direction","left");break;case 39:case 68:l.classList.remove("engage"),n=""!==t?window.draggingDirection:"right",o=document.getElementById(window.mainCharacter+"-"+n+t+window.currentWeapon),o&&o.classList.add("engage"),i.className="",i.classList.add("right-dir"),m&&m.setAttribute("data-direction","right");break;case 40:case 83:l.classList.remove("engage"),n=""!==t?window.draggingDirection:"down",o=document.getElementById(window.mainCharacter+"-"+n+t+window.currentWeapon),o&&o.classList.add("engage"),i.className="",i.classList.add("down-dir"),m&&m.setAttribute("data-direction","down")}!function(){const e=document.getElementById("walking");e&&void 0!==e?.src&&""!==e.src&&(e.loop=!0,window.sfxVolume&&(e.volume=window.sfxVolume),e.play())}()}else!function(){const e=document.getElementById("walking");e&&(e.pause(),e.currentTime=0)}();const h=c.offsetWidth-l.offsetWidth,v=parseInt(e,10)-(a[t]?o:0)+(a[n]?o:0);return v<0?0:v>h?h:v}function fe(e,t,n){let a=parseInt(n.style.left.replace("px","")),o=parseInt(n.style.top.replace("px",""));t&&(a=a+400<parseInt(t.style.left.replace("px"))?a-e:a+e,o=o+400<parseInt(t.style.top.replace("px"))?o-e:o+e,n.style.left=a+"px",n.style.top=o+"px")}function we(e){const t=document.querySelectorAll(`.map-item[data-mission="${e}"]`),n=document.querySelectorAll(`.enemy-item[data-mission="${e}"]`);return 1>=t.length&&0===n.length}function he(e,t,n){return"strength"===n?"yes"===e.dataset.isstrong&&"strength"===t.dataset.ability||void 0===e.dataset.isstrong||"no"===e.dataset.isstrong:n===t.dataset.ability}function ve(e){const t=e.dataset?.interacted;t&&""!==t&&(e.style.background=`url(${t}) no-repeat`,e.style.backgroundSize="cover","true"===e.dataset.passable&&e.classList.add("passable"))}function be(e,t){const n={area:e,item:t};fetch(`${OrbemOrder.siteRESTURL}/save-materialized-item/`,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":OrbemOrder.orbemNonce},body:JSON.stringify(n)}).then((e=>{if(!e.ok)throw new Error("Network response was not ok "+e.statusText)}))}function Se(e,t,n,a){window.allowHit=!1;const o=document.querySelector(".indicator-icon");if(window.allowIndicate&&e&&o&&!1===o.classList.contains("engage")){const s=e.style.left.replace("px",""),r=e.style.top.replace("px",""),c=e.getBoundingClientRect().width/2-7.5,i=Ne(e.className);o&&(o.classList.add("engage"),o.style.left=c+parseInt(s)+"px",o.style.top=parseInt(r)-25+"px",!0===t&&(o.dataset.sign="",o.dataset.minigame="",o.dataset.cutscene=n.dataset.triggee),!1===t&&(o.dataset.cutscene="",o.dataset.minigame="",o.dataset.sign=i),!0===a&&(o.dataset.cutscene="",o.dataset.sign="",o.dataset.minigame=e.dataset.minigame))}}function Le(e){const t=e.getAttribute("data-type"),n=e.getAttribute("data-value"),a=e.id,o=Ne(e.className),s=document.createElement("span"),r=function(e){return{health:"items",mana:"items",gear:"gear",weapons:"weapons"}[e]}(t),c=document.querySelector('[data-menu="'+r+'"]'),i=document.querySelector(`#explore-points .${t}-amount`);let l=100;if(i&&(l=i.getAttribute("data-amount")),"gear"===t||"health"!==t&&"mana"!==t||!(100>l)){if(s.setAttribute("data-type",t),s.setAttribute("data-id",a),s.setAttribute("data-value",n),s.setAttribute("title",o),s.setAttribute("data-empty","false"),"gear"===t||"weapons"===t){const t=getComputedStyle(e);s.setAttribute("data-width",t.width.replace("px","")),s.setAttribute("data-height",t.height.replace("px","")),s.setAttribute("data-strength",e.dataset.strength);const n=document.createElement("img");n.setAttribute("src",e.dataset.image),n.setAttribute("width","80px"),n.style.objectFit="contain",s.append(n)}if(s.className="storage-item",c){const e=c.querySelector('.storage-item[data-empty="true"]'),r=c.querySelectorAll('.storage-item[data-empty="false"]');let i=!0;e&&(e.remove(),r&&r.forEach((e=>{if(e.getAttribute("title")===o){let t=e.getAttribute("data-count");t=null!==t?parseInt(t)+1:2,e.setAttribute("data-count",t),i=!1}})),!0===i&&(c.prepend(s),s.addEventListener("click",(()=>{"true"!==s.dataset.empty&&G(s)}))),_(a,o,t,n,!1))}}}function xe(e){const t={cutscene:e};fetch(`${OrbemOrder.siteRESTURL}/set-previous-cutscene-area/`,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":OrbemOrder.orbemNonce},body:JSON.stringify(t)}).then((e=>{if(!e.ok)throw new Error("Network response was not ok "+e.statusText)}))}function qe(e,t){const n=void 0===e?.className?document.querySelector("."+e+"-map-cutscene"):e;if(e=void 0===e?.className?e:Ne(e.className),!n||void 0!==n.dataset?.video&&"false"!==n.dataset?.video){if(n&&"true"===n.dataset?.video&&!1===n.classList.contains("been-viewed")){const e=n.querySelector("video");if(window.allowMovement=!1,n.classList.add("engage"),e){"yes"===n.dataset?.mutemusic&&window.currentMusic&&window.currentMusic.pause(),e.play(),e.muted=!1,e.addEventListener("ended",(()=>{window.allowMovement=!0,ke(n,0,!1)}));const t=document.getElementById("skip-cutscene-video");t&&t.addEventListener("click",(()=>{window.allowMovement=!0,e.pause(),ke(n,0,!1)}))}}}else{const a=n.querySelectorAll("p, .wp-block-orbem-paragraph-mp3"),o=document.getElementById("map-character"),s=Ne(n.querySelector(".wp-block-orbem-paragraph-mp3:not(.explore-character-"+o?.dataset?.mainid+")")?.className),r=document.getElementById(s);if(!1===n.classList.contains("been-viewed")){window.allowMovement=!1,window.allowHit=!1,function(e){const t=JSON.parse(e.getAttribute("data-character-position")),n=document.getElementById("map-character");(function(e,t,n){const a=document.querySelector("."+t+"-map-item"),o=e.querySelector(".map-character-icon.engage");if(a){const t=parseInt(a.style.left.replace("px",""))+25,s=parseInt(a.style.top.replace("px",""))+25,r=t+a.offsetWidth-50,c=s+a.offsetHeight-50,i=parseInt(e.style.left.replace("px","")),l=parseInt(e.style.top.replace("px","")),d=i+(400-o.offsetWidth/2),u=d+o.offsetWidth,m=l+(400-o.offsetHeight/2);let p,g=!1;switch(p=d>r&&"left",p=u<t?"right":p,p=m>c?"up":p,p=m+o.offsetHeight<s?"down":p,p){case"left":g="right";break;case"right":g="left";break;case"up":g="down";break;case"down":g="up"}!1!==p&&(Ce(e,p,!1),"no"!==n.dataset?.npcfaceme&&D(g,a))}})(n,e.dataset.character,e),t&&0<t.length&&void 0!==t[0]&&(window.allowCutscene=!1,We(n,t[0].top,t[0].left,!0,e))}(n),r&&(setTimeout((()=>{r.scrollIntoView({behavior:"smooth",block:"nearest"})}),500),r.dataset.cutscenebreak="true"),n.classList.add("engage"),n.dataset.music&&""!==n.dataset.music&&te(n.dataset.music,e),"yes"===n.dataset?.mutemusic&&window.currentMusic&&window.currentMusic.pause();let i=a[0];a[0]&&a[0].classList.contains("wp-block-orbem-paragraph-mp3")&&(i=a[0].querySelector("p"));const l=i.innerText;i.innerText="";let d=0;const u=(e,t,n)=>{clearTimeout(c),n<t.length?(e.innerHTML+=t.charAt(n),n++,c=setTimeout((function(){d++,!1===/^[a-zA-Z]+$/.test(t.charAt(n))&&(d=0),u(e,t,n)}),50)):window.nextDialogueTimeout=setInterval((()=>{!0===window.nextDialogue&&(m(),clearInterval(window.nextDialogueTimeout),window.nextDialogue=!1)}),500)};u(i,l,0);const m=()=>{""!==w&&w.stop(),""!==h&&(h.pause(),h.currentTime=0),clearInterval(window.nextDialogueTimeout);let e=n.querySelector("p.engage, .wp-block-orbem-paragraph-mp3.engage").nextElementSibling;if(a.forEach((e=>{e.classList.remove("engage")})),e){e.classList.add("engage");let t=e.querySelector("audio");t=null!=t&&t;const n=e.querySelector("p"),a=n.innerText;n.innerText="",u(n,a,0),g(),je(a,e.dataset.voice,t)}else{if(clearTimeout(c),clearInterval(window.nextDialogueTimeout),n.classList.remove("engage"),n.removeEventListener("click",p),document.removeEventListener("keydown",p),"yes"!==document.querySelector(".default-map").dataset.iscutscene){const e=document.getElementById("map-character");document.querySelector('div[data-character="'+e.dataset?.mainid+'"].cut-character').classList.remove("engage")}window.allowMovement=!0,a[0].classList.add("engage"),ke(n,0,s),n.style.removeProperty("position"),n.style.removeProperty("display"),n.style.removeProperty("width"),n.style.removeProperty("max-height"),n.style.removeProperty("height"),n.style.removeProperty("transform"),n.style.removeProperty("left"),n.style.removeProperty("top")}},p=e=>{!0===window.allowCutscene&&"Space"===e.code&&a&&n.classList.contains("engage")&&m()};n.classList.add("been-viewed"),window.allowCutscene=!0;const g=(e="")=>{const a=n.querySelector(".wp-block-orbem-paragraph-mp3.engage");let s=a.querySelector("audio");s=null!=s&&s;const r=Ne(a.className),c=o.dataset?.mainid!==r?document.getElementById(r):o;let i=a.dataset.voice;const l=a.dataset?.triggerpath;let d=document.getElementById(r);const u=n.querySelector('.cut-character[data-character="'+r+'"]'),m=n.querySelector('.character-name[data-character="'+r+'"]');if(o&&(d=o.dataset.mainid===r?o:d),!0===t){if(c&&n){let e=parseInt(c.style.left.replace("px",""))-n.offsetWidth/2,t=parseInt(c.style.top.replace("px",""))+c.offsetHeight/2;o.dataset?.mainid===r&&(e+=o.offsetWidth/2),n.style.left=e+"px",n.style.top=t+"px";const a=document.querySelector(".engage.character-name");a&&(a.classList.remove("engage"),m.classList.add("engage"))}}else if(o){const e=n.querySelector(".engage.cut-character"),t=n.querySelector(".engage.character-name");e&&t&&(t.classList.remove("engage"),e.classList.remove("engage"),u.classList.add("engage"),m.classList.add("engage"))}l&&d&&M(d,!1),""!==e&&(je(e,i,s),o&&u&&u.classList.add("engage"),o&&m&&m.classList.add("engage"))};g(l),document.addEventListener("keydown",p),!0===t&&Oe()}}}function Ee(){const e=document.querySelectorAll(".communication-wrapper");e&&e.forEach((e=>{e.addEventListener("click",(t=>{(!t.target.closest(".map-communicate")&&!1===t.target.classList.contains("map-communicate")||!1===e.classList.contains("engage"))&&(!1===e.classList.contains("engage")?(e.classList.add("engage"),e.classList.remove("notify")):e.classList.remove("engage"))}));const t=e.querySelectorAll(".map-communicate");t&&t.forEach((t=>{const n=t.querySelectorAll("p, .wp-block-orbem-paragraph-mp3"),a=t.dataset.type;t.addEventListener("click",(()=>{"voicemail"===a&&!0===e.classList.contains("engage")?((e="")=>{const n=t.querySelector(".wp-block-orbem-paragraph-mp3.engage");let a=n.querySelector("audio");a=null!=a&&a;let o=n.dataset.voice;""!==e&&je(e,o,a)})(n[0].innerText):!0===e.classList.contains("engage")&&t.classList.toggle("show")})),t.dataset.music&&""!==t.dataset.music&&te(t.dataset.music,Ne(t.className)),"yes"===t.dataset?.mutemusic&&window.currentMusic&&window.currentMusic.pause()}))}))}function ke(e,t,n){e.classList.remove("engage"),window.nextAreaMissionComplete="";const a=Ne(e.className).replace(" ",""),o=e.dataset.boss,s=!!n&&document.getElementById(n),r=document.querySelector(".indicator-icon"),c=e.dataset?.communicate,i=document.querySelector('[data-materializecutscene="'+a+'"]');if(i&&!1===i.classList.contains("enable")&&i.classList.add("enable"),c&&""!==c){const e=document.querySelector("."+c+"-map-item");e&&e.classList.add("dependent")}r&&r.classList.remove("engage"),""!==e.dataset?.type&&void 0!==e.dataset?.type&&Re(e,a,!1,e.dataset.value,"");const l=document.querySelector('[data-character="'+window.mainCharacter+'"]');l&&l.classList.remove("engage");let d="";OrbemOrder.musicNames&&(d=JSON.parse(OrbemOrder.musicNames)[I]),("yes"===e.dataset.mutemusic||e.dataset.music&&""!==e.dataset.music)&&d&&te(d,I),""!==h&&(h.pause(),h.currentTime=0);const u=document.querySelector('[data-trigger-cutscene="'+a+'"]'),m=void 0!==e.dataset?.path;(u||m)&&function(){const e=document.getElementById("map-character"),t=parseInt(e.style.left.replace("px","")),n=parseInt(e.style.top.replace("px",""));switch(e.className.replace("-dir","")){case"right":e.style.left=t-30+"px";break;case"left":e.style.left=t+30+"px";break;case"top":e.style.top=n+30+"px";break;case"down":e.style.top=t-30+"px"}}(),u&&M(u,!1),m&&M(s,e);let p=document.querySelectorAll("[data-removeaftercutscene]");p&&Ie(p,a);let g=document.querySelectorAll('[data-showaftercutscene="'+a+'"]');g&&(g.forEach((e=>{e.classList.add("no-point"),y.push(Ne(e.className))})),be(I,y));const f=e.dataset.nextarea,w=e.getAttribute("data-nextarea-position"),v=e.dataset.mapurl,b=document.querySelector(".map-weapon"),S=e.dataset.missioncomplete;S&&(J(S,document.querySelector("."+S+"-mission-item"),S),window.nextAreaMissionComplete=S),f&&Z(f,b,v,w),setTimeout((()=>{if(window.allowHit=!0,window.faceNPC="",u&&"true"===u.dataset?.cutscenebreak&&(u.dataset.cutscenebreak="false"),s&&"true"===s.dataset?.cutscenebreak&&(s.dataset.cutscenebreak="false"),o&&""!==o){const e=document.querySelector("."+o+"-map-item");e&&ne(e)}}),100)}function Ie(e,t){e.forEach((e=>{t===e.dataset.removeaftercutscene&&(e.remove(),j(Ne(e.className),"point",0,2e3,"",!0))}))}function Oe(){const e=document.querySelector(".game-container");e&&(e.dataset.fadeout="",setTimeout((()=>{e.dataset.fadeout="false"}),1e3))}function Te(e,t){const n=void 0!==e.className?Ne(e.className):e;t="false"!==t?t:e.getAttribute("data-map-url");const a=document.querySelector(".map-weapon");a&&(a.style.display="none"),Z(n,a,t)}function Ae(){const e={};let t=!1;function n(t,n){const a=document.querySelector("#map-character");e[t.which]=!1,window.keyDown=!1,clearInterval(window.buttonShow),!0!==[37,38,39,40,87,65,83,68].includes(t.which)&&!0!==n||(window.coordinateTimeout=setTimeout((()=>{const e=document.querySelector("#map-character"),t=e.style.left,n=e.style.top;!1!==window.keyDown||t===window.charCurrentLeft&&n===window.charCurrentTop||(F(t,n),window.charCurrentLeft=t,window.charCurrentTop=n,clearInterval(window.coordinateTimeout))}),1e3),Ce(a,"",!1))}window.allowMovement=!0,window.keyDown=!1,clearInterval(window.movementInt),document.addEventListener("keydown",(function(n){e[n.which]=!0,t=n.which,clearInterval(window.buttonShow),clearTimeout(window.coordinateTimeout)})),document.addEventListener("keyup",(function(e){n(e,!1)})),document.addEventListener("touchend",(function(e){n(e,!0)})),document.querySelector(".top-left").addEventListener("touchstart",(function(t){t.preventDefault(),e[37]=!0,e[38]=!0,clearInterval(window.buttonShow),clearTimeout(window.coordinateTimeout)})),document.querySelector(".top-left").addEventListener("touchend",(function(t){t.preventDefault(),e[37]=!1,e[38]=!1,clearInterval(window.buttonShow),window.coordinateTimeout=setTimeout((()=>{const e=document.querySelector("#map-character");F(e.style.left,e.style.top)}),1e3)})),document.querySelector(".top-middle").addEventListener("touchstart",(function(t){t.preventDefault(),e[38]=!0,clearInterval(window.buttonShow)})),document.querySelector(".top-middle").addEventListener("touchend",(function(t){t.preventDefault(),e[38]=!1,clearInterval(window.buttonShow)})),document.querySelector(".top-right").addEventListener("touchstart",(function(t){t.preventDefault(),e[38]=!0,e[39]=!0,clearInterval(window.buttonShow)})),document.querySelector(".top-right").addEventListener("touchend",(function(t){t.preventDefault(),e[38]=!1,e[39]=!1,clearInterval(window.buttonShow)})),document.querySelector(".middle-left").addEventListener("touchstart",(function(t){t.preventDefault(),e[37]=!0,clearInterval(window.buttonShow)})),document.querySelector(".middle-left").addEventListener("touchend",(function(t){t.preventDefault(),e[37]=!1,clearInterval(window.buttonShow)})),document.querySelector(".middle-right").addEventListener("touchstart",(function(t){t.preventDefault(),e[39]=!0,clearInterval(window.buttonShow)})),document.querySelector(".middle-right").addEventListener("touchend",(function(t){t.preventDefault(),e[39]=!1,clearInterval(window.buttonShow)})),document.querySelector(".bottom-left").addEventListener("touchstart",(function(t){t.preventDefault(),e[37]=!0,e[40]=!0,clearInterval(window.buttonShow)})),document.querySelector(".bottom-left").addEventListener("touchend",(function(t){t.preventDefault(),e[37]=!1,e[40]=!1,clearInterval(window.buttonShow)})),document.querySelector(".bottom-middle").addEventListener("touchstart",(function(t){t.preventDefault(),e[40]=!0,clearInterval(window.buttonShow)})),document.querySelector(".bottom-middle").addEventListener("touchend",(function(t){t.preventDefault(),e[40]=!1,clearInterval(window.buttonShow)})),document.querySelector(".bottom-right").addEventListener("touchstart",(function(t){t.preventDefault(),e[39]=!0,e[40]=!0,clearInterval(window.buttonShow)})),document.querySelector(".bottom-right").addEventListener("touchend",(function(t){t.preventDefault(),e[39]=!1,e[40]=!1,clearInterval(window.buttonShow)})),window.movementInt=setInterval((function(){const n=document.getElementById("map-character"),a=document.querySelector(".map-weapon");let o=n.style.left,s=n.style.top;const r=parseInt(o,10),c=Be(parseInt(s,10),r,!1),i=document.querySelector(".dragme");if(window.allowMovement){Object.values(e).includes(!0)&&(window.keyDown=!0);const o=ye(c.top,e[87]?87:38,e[83]?83:40,e,window.moveSpeed,t),s=ye(c.left,e[65]?65:37,e[68]?68:39,e,window.moveSpeed,t);n.style.top=o+"px",n.style.left=s+"px",a&&!0===window.weaponConnection&&(a.style.top=o+T+"px",a.style.left=s+A+"px"),i&&(window.dragTop&&!1!==window.dragTop&&(i.style.top=window.dragTop.higher?o+450-window.dragTop.offset+"px":o+450+window.dragTop.offset+"px"),window.dragLeft&&!1!==window.dragLeft&&(i.style.left=window.dragLeft.left?s+450-window.dragLeft.offset+"px":s+450+window.dragLeft.offset+"px")),n.scrollIntoView({block:"nearest"})}}),16)}function Ne(e){if("string"==typeof e)return e.replace("wp-block-group map-item ","").replace("-map-item","").replace("drag-dest ","").replace(" completed-mission","").replace("wp-block-group enemy-item ","").replace(" no-point","").replace(" is-layout-flow","").replace(" wp-block-group-is-layout-flow","").replace(" engage","").replace("wp-block-group map-cutscene ","").replace("-map-cutscene","").replace("been-viewed","").replace(" path-onload","").replace(" start-timer","").replace("materialize-item-trigger ","").replace("-materialize-item","").replace("mission-trigger ","").replace(" hit","").replace("-minigame-item","").replace("minigame ","").replace(" pulse-wave-engage","").replace(" barage-wave-engage","").replace(" selected","").replace("-cutscene-trigger","").replace("cutscene-trigger ","").replace("next-mission ","").replace("-mission-item","").replace("mission-item ","").replace("wp-block-orbem-paragraph-mp3 ","").replace("explore-character-","")}function Ce(e,t,n){const a=document.querySelector(".map-character-icon.engage");if(a&&""===window.currentCharacterAutoDirection||a&&""!==t){let o=a.id.replace("left-punch","left").replace("right-punch","right").replace("up-punch","up").replace("down-punch","down").replace(window.mainCharacter+"-",window.mainCharacter+"-static-");""!==(t=""!==window.isDragging?window.draggingDirection:t)&&(o=window.mainCharacter+"-static-"+t+window.isDragging);const s=n&&C!==window.currentWeapon?window.currentWeapon:"",r=document.getElementById(o+s);r&&(a.classList.remove("engage"),r.classList.add("engage"),e.dataset.static="true")}}function Be(e,t,n){let a=e,o=t;const s=!1!==n?".map-character-icon.engage, ":"",r=document.getElementById("map-character"),c=!1!==(n=n||document.querySelector(".map-character-icon.engage"))&&"hazard"===r.dataset.ability?':not([data-hazard="true"])':"";return Me(document.querySelectorAll(s+".default-map svg rect, .map-item"+c+':not([data-wanderer="yes"]):not(.explainer-container):not(.materialize-item-trigger):not(.drag-dest):not([data-trigger="true"]):not(.currently-dragging):not([data-passable="true"].no-point):not(.passable):not([data-genre="explore-sign"]):not([data-foreground="true"]):not([data-background="true"]), .enemy-item'),n,parseInt(a),parseInt(o),!1,""!==s)}function Me(e,t,n,a,o,s){const r=a,c=n;let i={top:n,left:a,collide:!1};const l=document.getElementById("map-character"),d={offsetLeft:l.offsetLeft+(400-t.offsetWidth/2),offsetWidth:t.offsetWidth,offsetTop:l.offsetTop+(400-t.offsetHeight/2),offsetHeight:t.offsetHeight},u=!0===s?t:d;return e&&(!1===window.godMode&&!0!==s||!0===s)&&e.forEach((e=>{let n=e;if(!0===n.id.includes("mc-")&&(n=d),t!==e&&Pe(u,n,0)){const e=n.offsetLeft+n.offsetWidth,t=n.offsetLeft,a=n.offsetTop,l=n.offsetTop+n.offsetHeight,d=u.offsetLeft+u.offsetWidth,m=u.offsetLeft,p=u.offsetTop,g=u.offsetTop+u.offsetHeight;i.collide=!0;const y=l>p&&a<p&&l<p+10,f=a<g&&l>g&&a>g-10,w=e>m&&t<m,h=t<d&&e>d;let v=!0===o?5:window.moveSpeed;v=!0===s?1:v,!w||h||y||f||(i.left=r+v,i.collide=!0),!h||w||y||f||(i.left=r-v,i.collide=!0),y&&!f&&(i.top=c+v,i.collide=!0),f&&!y&&(i.top=c-v,i.collide=!0)}})),i}function Pe(e,t,n){const a=e.offsetLeft+e.offsetWidth,o=e.offsetLeft,s=e.offsetTop,r=e.offsetTop+e.offsetHeight,c=t.offsetLeft+t.offsetWidth,i=t.offsetLeft,l=t.offsetTop,d=t.offsetTop+t.offsetHeight;return 0==(a+n<i-n||o+n>c-n||r+n<l-n||s-n>d+n)}function Re(e,t,n,a,o){let s=e.dataset.type;s=s&&""!==s?s:"point",!1===e.classList.contains("map-cutscene")&&e.classList.add("engage");const r=document.querySelector(`#explore-points .${s}-amount`);let c=100;const i=!0===n?parseInt(a):parseInt(e.dataset?.value);if(r&&0<i){if(c=r.dataset.amount,"point"===s){const e=parseInt(c)+parseInt(null!=i?i:"0");r.setAttribute("data-amount",e);const t=$e(c),n=$e(e);if(window.nextLevelPointAmount=JSON.parse(OrbemOrder.levelMaps)[n],t!==n){const e=document.querySelector(".current-level");e&&(e.textContent="lvl. "+n,document.querySelector(".next-level-points").textContent=window.nextLevelPointAmount)}const a=document.querySelector(".my-points");a&&(a.textContent=e)}r.classList.add("engage"),setTimeout((function(){r.classList.remove("engage")}),2e3);const n=e.classList.contains("storage-item");!function(e){const t=document.getElementById("map-character");t.classList.add("point"),""!==e&&t.classList.add(e),setTimeout((function(){t.classList.add("over"),setTimeout((function(){""!==e&&t.classList.remove(e),t.classList.remove("point"),t.classList.remove("over")}),500)}),1e3);const n=document.getElementById("ching");n&&(n.volume=window.sfxVolume,n.play())}(s),$(parseInt(c)+parseInt(i),s,t,n,o)}}function De(){const e=document.querySelector(".game-container"),t=document.querySelector("#map-character");document.addEventListener("keydown",(n=>{16===n.keyCode&&he("",t,"programming")&&e.addEventListener("click",He)})),document.addEventListener("keyup",(n=>{16===n.keyCode&&he("",t,"programming")&&e.removeEventListener("click",He)}))}function He(e){const t=document.querySelector(".game-container").getBoundingClientRect(),n=e.clientX-t.left-400,a=e.clientY-t.top-400,o=document.getElementById("map-character"),s=document.querySelector(".power-amount"),r=s.querySelector(".gauge"),c=s.getAttribute("data-amount");if(clearInterval(window.rechargeInterval),0<c){!o||"rect"===e.target.tagName||"true"!==e.target.dataset.collectable&&!1!==e.target.classList.contains("map-item")&&"true"!==e.target.dataset.hazard||We(o,a,n,!1,!1);const t=c<0?0:c-25;s.setAttribute("data-amount",t),r.style.width=t+"px"}26>c&&function(e,t){window.rechargeInterval=setInterval((()=>{const n=parseInt(t.getAttribute("data-amount"));100<=n?clearInterval(window.rechargeInterval):(t.setAttribute("data-amount",n+1),e.style.width=n+1+"px")}),1500)}(r,s)}function We(e,t,n,a,o){const s=parseInt(e.style.left.replace("px","")),r=parseInt(e.style.top.replace("px","")),c=s>n,i=r>t,l=c?s-n:n-s,d=i?r-t:t-r;let u=0;const m=document.querySelector(".map-weapon");if(a){clearInterval(window.movementInt),e.classList.add("auto-move");const a=Math.max(d,l),p=setInterval((()=>{if(u<=a){let a="",o="";i?(e.style.top=u<=d?r-u+"px":t+"px",m.style.top=parseInt(e.style.top.replace("px",""))+400+"px",a="up"):(e.style.top=u<=d?r+u+"px":t+"px",m.style.top=parseInt(e.style.top.replace("px",""))+400+"px",a="down"),c?(e.style.left=u<=l?s-u+"px":n+"px",m.style.left=parseInt(e.style.left.replace("px",""))+400+"px",o="left"):(e.style.left=u<=l?s+u+"px":n+"px",m.style.left=parseInt(e.style.left.replace("px",""))+400+"px",o="right"),function(e,t,n){let a=""===e?t:e;const o=n.querySelector(".map-character-icon.engage");if(a!==window.currentCharacterAutoDirection){const e=n.querySelector("#"+window.mainCharacter+"-"+a+window.currentWeapon);window.currentCharacterAutoDirection=a,n.classList.add(a+"-dir"),o&&o.classList.remove("engage"),e&&e.classList.add("engage"),n.className=""}}(a,o,e)}else{window.allowCutscene=!0;const t=e.querySelector(".map-character-icon.engage");if(t&&!1===t.id.includes("static")){t.classList.remove("engage");const e=document.getElementById(t.id.replace(window.mainCharacter,window.mainCharacter+"-static"+window.currentWeapon));e&&(e.classList.add("engage"),window.currentCharacterAutoDirection="")}!1!==o&&!1!==o.classList.contains("engage")||(clearInterval(p),Ae())}u++}),window.moveSpeed)}else e.style.left=n+"px",e.style.top=t+"px"}function $e(e){if(OrbemOrder.levelMaps){const t=JSON.parse(OrbemOrder.levelMaps);for(const n in t)if(e>t[n]&&e<t[parseInt(n)+1]||e===t[n])return parseInt(n)+1}return 1}async function je(e,t,n){if(!0!==e.includes("**")&&""!==e&&"â€¦"!==e&&"..."!==e){if(!1!==n&&(h=n,h.volume=function(e,t=-40,n=16){return(parseInt(window.talkingVolume)-t)/(n-t)}(),h.play(),h.addEventListener("ended",(()=>{window.nextDialogue=!0}))),!1===n){var a;const n=`https://texttospeech.googleapis.com/v1/text:synthesize?key=${null!==(a=OrbemOrder.TTSAPIKEY)&&void 0!==a?a:""}`;let o=0,s=1.2;const r={input:{ssml:"<speak>"+e+"</speak>"},voice:{name:t,languageCode:"en-US"},audioConfig:{audioEncoding:"MP3",volumeGainDb:parseInt(window.talkingVolume)+7}};o&&s&&(r.audioConfig.pitch=o,r.audioConfig.speakingRate=s);try{const e=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!e.ok)return;const t=await e.json(),a=t?.audioContent;h=new Audio(`data:audio/mp3;base64,${a}`),h.volume=.5,h.play(),h.addEventListener("ended",(()=>{window.nextDialogue=!0}))}catch(e){window.audioError=e.message}}}else setTimeout((()=>{window.nextDialogue=!0}),1500)}function ze(e){const t=document.getElementById("start-screen-music"),n=document.getElementById("music-unmute");if(t&&!1!==e){t.volume=0,t.play(),t.muted=!1,n&&(n.textContent="ðŸ”‰",n.addEventListener("click",(()=>{t.muted=!t.muted,n.textContent=t.muted?"ðŸ”‡":"ðŸ”‰"})));const e=setInterval((()=>{t.volume<.7?t.volume+=.1:clearInterval(e)}),300)}else t&&(t.remove(),n.remove())}function Je(){setInterval((()=>{if(!0===E){const e=window.theHazardValue,t=ee("health"),n=parseInt(t)-parseInt(e);Xe(),$(n,"health","hazard","")}if(!1!==k){const e=document.getElementById("map-character");fe(25,k,e)}}),1e3)}function Xe(){clearTimeout(m);const e=document.getElementById("map-character");e&&(e.dataset.hurt=!0,m=setTimeout((()=>{e.dataset.hurt=!1}),1e3))}function Ue(e,t){e&&(e.classList.add(t),setTimeout((function(){e.classList.remove(t)}),1e3))}"function"!=typeof window.exploreHandleCredentialResponse&&(window.exploreHandleCredentialResponse=function(e){const t=`${OrbemOrder.siteRESTURL}/google-oauth-callback/`,n=document.getElementById("g_id_onload"),a={credential:e.credential,nonce:n?.dataset?.nonce||""};fetch(t,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":OrbemOrder.orbemNonce},body:JSON.stringify(a)}).then((e=>{if(!e.ok)throw new Error("Network response was not ok "+e.statusText);return e.json()})).then((e=>{e.success&&window.location.reload()}))})}},t={};function n(a){var o=t[a];if(void 0!==o)return o.exports;var s=t[a]={exports:{}};return e[a](s,s.exports,n),s.exports}n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n(911)})();