(()=>{"use strict";const e=window.wp.blockEditor,t=window.wp.blocks,o=window.wp.components,r=window.wp.data,s=window.wp.i18n,l=window.ReactJSXRuntime;(0,t.registerBlockType)("orbem/paragraph-mp3",{title:(0,s.__)("Paragraph with MP3","custom"),description:(0,s.__)("A paragraph block with an MP3 upload option.","custom"),category:"orbem-order-game-engine",icon:"media-audio",supports:{html:!1},attributes:{content:{type:"string",source:"html",selector:"p"},mp3Url:{type:"string",default:""},selectedTerm:{type:"string",default:""},selectedVoice:{type:"string",default:""}},edit:({attributes:t,setAttributes:c})=>{const a=(0,r.useSelect)((e=>e("core").getEntityRecords("taxonomy","explore-character-point",{per_page:-1})),[]),{content:n,mp3Url:i,selectedTerm:p,selectedVoice:d}=t,u=(m=p,(0,r.useSelect)((e=>{const t=e("core").getEntityRecords("postType","explore-character",{slug:m,per_page:1});if(!t||0===t.length)return null;const o=t[0].id,r=e("core").getEntityRecord("postType","explore-character",o)?.meta;return r?r["explore-voice"]:null}),[m]));var m;return d===u&&null!=d||c({selectedVoice:u}),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(e.InspectorControls,{children:[(0,l.jsxs)(o.PanelBody,{title:(0,s.__)("MP3 File","custom"),children:[(0,l.jsx)(e.MediaUploadCheck,{children:(0,l.jsx)(e.MediaUpload,{onSelect:e=>c({mp3Url:e.url}),allowedTypes:["audio"],render:({open:e})=>(0,l.jsx)(o.Button,{onClick:e,variant:"secondary",children:i?(0,s.__)("Replace MP3","custom"):(0,s.__)("Upload MP3","custom")})})}),i&&(0,l.jsx)("div",{style:{marginTop:"10px"},children:(0,l.jsx)("audio",{controls:!0,src:i,style:{width:"100%"}})})]}),(0,l.jsx)(o.PanelBody,{title:(0,s.__)("Explore Character Select","custom"),children:Array.isArray(a)?a.length>0?(0,l.jsx)(o.SelectControl,{label:(0,s.__)("Select a Character","custom"),value:p,options:[{label:(0,s.__)("None","custom"),value:null},...a.map((e=>({label:e.name,value:e.slug})))],onChange:e=>{c({selectedTerm:e,selectedVoice:u})}}):(0,l.jsx)("p",{children:(0,s.__)("No terms found.","custom")}):(0,l.jsx)("p",{children:(0,s.__)("Loading terms...","custom")})})]}),(0,l.jsxs)("span",{className:p,"data-voice":d,children:[(0,l.jsx)(e.RichText,{tagName:"p",value:n,onChange:e=>c({content:e}),placeholder:(0,s.__)("Write your paragraph here...","custom")}),i&&(0,l.jsx)("audio",{controls:!0,src:i,style:{position:"absolute",left:"-56000px"}})]})]})},save:({attributes:t})=>{const{content:o,mp3Url:r,selectedTerm:s,selectedVoice:c}=t,a=s||"";return(0,l.jsxs)("span",{className:a,"data-voice":c,children:[(0,l.jsx)(e.RichText.Content,{tagName:"p",value:o}),r&&(0,l.jsx)("audio",{controls:!0,src:r,style:{position:"absolute",left:"-56000px"}})]})}})})();